<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Upgrades V1.0.0 Doc</title><link rel="stylesheet" type="text/css" href="https://openenergydashboard.org/assets/css/styles_feeling_responsive.css"> <script src="https://openenergydashboard.org/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <noscript><link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'> </noscript><meta name="description" content="Version V1.0.0 Documentation overview Admin documentation Information Overview Standard Units Pages Units &amp; Conversions Site Management Conversion Creating Conversion Editing Conversion Viewing Group Creating Group Editing Group Map Creating Map Viewing Meter Creating Meter Editing Meter Viewing Site Settings Unit Creating Unit Editing Unit Viewing User Data Acquisition CSV Import Data Acquisition eGauge MAMAC Meter Import Reading Import Site Installation Production Install Output Installation Directions Upgrades Upgrades V1.0.0 User documentation User help Documentation versions for this page V1.0.0 (current page) These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user. OED Upgrades Through OED v1.0.0 If you are migrating though v1.0.0 then special steps are needed. This is due to the need for a major database upgrade. You are doing this type of migration if the current version is below v1.0.0 but the new version is v1.0.0 or above. This is a onetime process so it is not needed if you are upgrading starting with a version at or beyond v1.0.0. Introduction The following steps are meant to migrate OED&#39;s Postgres version across multiple major versions, specifically from 10.13 to 15.3 when going to OED v1.0.0, with the help of two scripts to automate as much of the process as possible. Before starting, make sure OED and its Docker containers are running. As with other migration work, be sure to be working in the main OED directory. Since this is a unique step and some sites may have difficulties, you are welcome to reach out to the OED project to get help in doing this or address any concerns you may have. Getting the scripts You need two scripts from OED v1.0.0 to perform this migration. Unfortunately, they are used before the software is updated. Use the links for each file to go to the GitHub repository. Place each file in the OED main directory by doing one of the following (in likely order of what is easiest to hardest to do): Use the &quot;download raw file&quot; button to get the file. You will likely need to then move file from wherever your web browser downloads files to the main OED directory. Use the &quot;copy raw file&quot; button to get the file. In the terminal/shell in the main OED directory do the following: cat &gt; restoreDatabase.sh Paste the file contents copied from GitHub in the previous step. Enter control-d meaning control and d keys at the same time. This will end the input of the file contents. As a last resort, you can create a new directory and clone OED v1.0 into that directory. You should then be able to copy the files from src/server/migrations/scripts/ into the main directory of OED you are upgrading. You will not need this clone after this so you can delete this clone. The links for the two files are: dumpDatabase.sh restoreDatabase.sh Running the first script The first script is called dumpDatabase.sh and it should be in the main OED directory after the steps above. Run the script in the main OED directory by running the command: bash dumpDatabase.sh The script will then run the first steps of the database migration, eventually prompting the user to reset the passwords for the database users oed and postgres. It will display the passwords that it should be reset to based on the environment variables, and the user must enter it in twice and make sure that no error messages occur. It is okay to copy the password shown and paste it into the requested password. Afterwards, the script will create a database dump file called script_database_dump.sql in the main OED directory where the script was run from. Shutting down OED The first script requires OED to be running but the second script requires OED to be shut down. Please shut down OED before running the next script. See the step in the admin upgrading page for details on doing this. Running the second script The second script is called restoreDatabase.sh and it should be in the main OED directory after the steps above. Run the script in the main OED directory by running the command: bash restoreDatabase.sh The second script will remove the postgres version 10.13 database container and bring up a container with postgres version 15.3. It will restore the dump to the new database container and bring it back down again, leaving OED in a shut down state. This can take a couple of minutes. After script finishes running successfully, the database migration is complete. If you are asked about descending and/or removing a write protected directory (postgres-data) then you should answer &#39;y&#39; (without the quotes). Removing files This process created three files that are no longer needed. To keep your software directory clean and to save space, it is best to remove them before continuing with a standard upgrade. Do the following in a terminal/shell in the main OED directory: rm dumpDatabase.sh restoreDatabase.sh script_database_dump.sql Note that not doing this could cause a git merge issue when you do the rest of the upgrade. Continuing upgrade At this point you can continue the standard upgrade process from the next step."><meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ"><meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" ><link rel="canonical" href="https://openenergydashboard.org/helpV1_0_0/adminUpgradingV1/"><meta property="og:title" content="Upgrades V1.0.0 Doc"><meta property="og:description" content="Version V1.0.0 Documentation overview Admin documentation Information Overview Standard Units Pages Units &amp; Conversions Site Management Conversion Creating Conversion Editing Conversion Viewing Group Creating Group Editing Group Map Creating Map Viewing Meter Creating Meter Editing Meter Viewing Site Settings Unit Creating Unit Editing Unit Viewing User Data Acquisition CSV Import Data Acquisition eGauge MAMAC Meter Import Reading Import Site Installation Production Install Output Installation Directions Upgrades Upgrades V1.0.0 User documentation User help Documentation versions for this page V1.0.0 (current page) These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user. OED Upgrades Through OED v1.0.0 If you are migrating though v1.0.0 then special steps are needed. This is due to the need for a major database upgrade. You are doing this type of migration if the current version is below v1.0.0 but the new version is v1.0.0 or above. This is a onetime process so it is not needed if you are upgrading starting with a version at or beyond v1.0.0. Introduction The following steps are meant to migrate OED&#39;s Postgres version across multiple major versions, specifically from 10.13 to 15.3 when going to OED v1.0.0, with the help of two scripts to automate as much of the process as possible. Before starting, make sure OED and its Docker containers are running. As with other migration work, be sure to be working in the main OED directory. Since this is a unique step and some sites may have difficulties, you are welcome to reach out to the OED project to get help in doing this or address any concerns you may have. Getting the scripts You need two scripts from OED v1.0.0 to perform this migration. Unfortunately, they are used before the software is updated. Use the links for each file to go to the GitHub repository. Place each file in the OED main directory by doing one of the following (in likely order of what is easiest to hardest to do): Use the &quot;download raw file&quot; button to get the file. You will likely need to then move file from wherever your web browser downloads files to the main OED directory. Use the &quot;copy raw file&quot; button to get the file. In the terminal/shell in the main OED directory do the following: cat &gt; restoreDatabase.sh Paste the file contents copied from GitHub in the previous step. Enter control-d meaning control and d keys at the same time. This will end the input of the file contents. As a last resort, you can create a new directory and clone OED v1.0 into that directory. You should then be able to copy the files from src/server/migrations/scripts/ into the main directory of OED you are upgrading. You will not need this clone after this so you can delete this clone. The links for the two files are: dumpDatabase.sh restoreDatabase.sh Running the first script The first script is called dumpDatabase.sh and it should be in the main OED directory after the steps above. Run the script in the main OED directory by running the command: bash dumpDatabase.sh The script will then run the first steps of the database migration, eventually prompting the user to reset the passwords for the database users oed and postgres. It will display the passwords that it should be reset to based on the environment variables, and the user must enter it in twice and make sure that no error messages occur. It is okay to copy the password shown and paste it into the requested password. Afterwards, the script will create a database dump file called script_database_dump.sql in the main OED directory where the script was run from. Shutting down OED The first script requires OED to be running but the second script requires OED to be shut down. Please shut down OED before running the next script. See the step in the admin upgrading page for details on doing this. Running the second script The second script is called restoreDatabase.sh and it should be in the main OED directory after the steps above. Run the script in the main OED directory by running the command: bash restoreDatabase.sh The second script will remove the postgres version 10.13 database container and bring up a container with postgres version 15.3. It will restore the dump to the new database container and bring it back down again, leaving OED in a shut down state. This can take a couple of minutes. After script finishes running successfully, the database migration is complete. If you are asked about descending and/or removing a write protected directory (postgres-data) then you should answer &#39;y&#39; (without the quotes). Removing files This process created three files that are no longer needed. To keep your software directory clean and to save space, it is best to remove them before continuing with a standard upgrade. Do the following in a terminal/shell in the main OED directory: rm dumpDatabase.sh restoreDatabase.sh script_database_dump.sql Note that not doing this could cause a git merge issue when you do the rest of the upgrade. Continuing upgrade At this point you can continue the standard upgrade process from the next step."><meta property="og:url" content="https://openenergydashboard.org/helpV1_0_0/adminUpgradingV1/"><meta property="og:locale" content="en_EN"><meta property="og:type" content="website"><meta property="og:site_name" content="Open Energy Dashboard"><link rel="icon" sizes="32x32" href="https://openenergydashboard.org/assets/img/OEDIcon22x32.png"><link rel="icon" sizes="192x192" href="https://openenergydashboard.org/assets/img/OEDIcon192x274.png"><body id="top-of-page" class="page-fullwidth"><div id="navigation" class="sticky"><nav class="top-bar" role="navigation" data-topbar data-options="scrolltop: false"><ul class="title-area"><li class="name"><h1 class="hide-for-large-up"><a href="https://openenergydashboard.org/" class="icon-tree"> Open Energy Dashboard</a></h1><li class="toggle-topbar toggle-topbar-click menu-icon"><a><span>Nav</span></a></ul><section class="top-bar-section"><ul class="left"><li><a href="https://openenergydashboard.org/">home</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/features/">features</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/features/">features by type</a><li><a href="https://openenergydashboard.org/useAcademic/">features by academic use</a></ul><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/helpV1_0_0/user/">Documentation</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/helpV1_0_0/user/">oed version 1.0.0</a><li><a href="https://openenergydashboard.org/helpV0_8_0/user/">oed version 0.8.0</a><li><a href="https://openenergydashboard.org/helpV0_7_0/user/">oed version 0.7.0</a><li><a href="https://openenergydashboard.org/helpV0_6_0/user/">oed version 0.6.0</a></ul><li class="divider"><li><a href="https://openenergydashboard.org/use/">Adopting</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/news/">info</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/news/">news</a><li><a href="https://openenergydashboard.org/principles/">project principles</a><li><a href="https://openenergydashboard.org/free/">free &amp; maintained</a><li><a href="https://openenergydashboard.org/mission/">mission</a><li><a href="https://openenergydashboard.org/why/">why exists</a><li><a href="https://openenergydashboard.org/projectInfo/">project information pages &amp; license</a><li><a href="https://openenergydashboard.org/name/">why OED name, logo &amp; some history</a></ul><li class="divider"></ul><ul class="right"><li class="divider"><li><a href="https://openenergydashboard.org/search/">Search</a><li class="divider"><li><a href="https://openenergydashboard.org/contact/">Contact</a><li class="divider"><li><a href="https://openenergydashboard.org/developer/developer/">developer docs</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/involved/">get involved</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/internship/">becoming a developer</a><li><a href="https://openenergydashboard.org/studentExperience/">student experience</a></ul></ul></section></nav></div><div id="masthead-no-image-header"><div class="row"><div class="small-6 small-centered columns"> <a id="logo" title="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard"> <img src="https://openenergydashboard.org/assets/img/logoHelp.png" alt="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard"> </a></div></div></div><nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs"> <a href="https://openenergydashboard.org/">Start</a> <a href="https://openenergydashboard.org/helpV1_0_0/">helpV1_0_0</a> <a class="current">Upgrades V1.0.0</a></nav><div class="row t15"><div class="medium-12 columns"><article><header><p class="subheadline">OED Documentation<h1>Upgrades V1.0.0</h1></header><div class="row"><p>Version V1.0.0<div class="medium-4 medium-push-8 columns" markdown="1"><div class="panel radius" markdown="1"><div style="list-style: none;" class="side-nav"><h4><a href='../admin/'>Documentation overview</a></h4><div><h5>Admin documentation</h5><div style="padding-left: 1em;"><h6>Information</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/admin/">Overview</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminOedUnits/">Standard Units</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminPageChoices/">Pages</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitInfo/">Units & Conversions</a></br></div></div><div style="padding-left: 1em;"><h6>Site Management</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionCreating/">Conversion Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionEditing/">Conversion Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionViewing/">Conversion Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupCreating/">Group Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupEditing/">Group Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupViewing/">Group</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapCreating/">Map Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapViewing/">Map Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterCreating/">Meter Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterEditing/">Meter Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterViewing/">Meter Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminPreferences/">Site Settings</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitCreating/">Unit Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitEditing/">Unit Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitViewing/">Unit Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUser/">User</a></br></div></div><div style="padding-left: 1em;"><h6>Data Acquisition</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminCsvImport/">CSV Import</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminDataAcquisition/">Data Acquisition</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminEgauge/">eGauge</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMamac/">MAMAC</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMetersImport/">Meter Import</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminReadingsImport/">Reading Import</a></br></div></div><div style="padding-left: 1em;"><h6>Site Installation</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminInstallOutput/">Production Install Output</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminInstallation/">Installation Directions</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgrading/">Upgrades</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgradingV1/">Upgrades V1.0.0</a></br></div></div><h5>User documentation</h5><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgradingV1/../user/">User help</a></br></div><h5>Documentation versions for this page</h5><div style="padding-left: 1em;"> V1.0.0 (current page)</br></div></div></div></div></div><div class="medium-8 medium-pull-4 columns" markdown="1"><div class="alert-box info "><p>These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user.</div><h1>OED Upgrades Through OED v1.0.0</h1><p>If you are migrating though v1.0.0 then special steps are needed. This is due to the need for a major database upgrade. You are doing this type of migration if the current version is below v1.0.0 but the new version is v1.0.0 or above. This is a onetime process so it is not needed if you are upgrading starting with a version at or beyond v1.0.0.<h2>Introduction</h2><p>The following steps are meant to migrate OED's Postgres version across multiple major versions, specifically from 10.13 to 15.3 when going to OED v1.0.0, with the help of two scripts to automate as much of the process as possible. Before starting, make sure OED and its Docker containers are running. As with other migration work, be sure to be working in the main OED directory.<p>Since this is a unique step and some sites may have difficulties, you are welcome to reach out to the OED project to get help in doing this or address any concerns you may have.<h2>Getting the scripts</h2><p>You need two scripts from OED v1.0.0 to perform this migration. Unfortunately, they are used before the software is updated. Use the links for each file to go to the GitHub repository. Place each file in the OED main directory by doing <strong>one</strong> of the following (in likely order of what is easiest to hardest to do):<ol><li> Use the "download raw file" button to get the file. You will likely need to then move file from wherever your web browser downloads files to the main OED directory.<li> Use the "copy raw file" button to get the file. In the terminal/shell in the main OED directory do the following:<ol><li><code>cat > restoreDatabase.sh</code><li>Paste the file contents copied from GitHub in the previous step.<li>Enter control-d meaning control and d keys at the same time. This will end the input of the file contents.</ol><li> As a last resort, you can create a new directory and clone OED v1.0 into that directory. You should then be able to copy the files from src/server/migrations/scripts/ into the main directory of OED you are upgrading. You will not need this clone after this so you can delete this clone.</ol><p>The links for the two files are:<ul><li><a href="https://github.com/OpenEnergyDashboard/OED/blob/v1.0.0/src/server/migrations/scripts/dumpDatabase.sh" target="_blank" rel="noopener noreferrer">dumpDatabase.sh</a><li><a href="https://github.com/OpenEnergyDashboard/OED/blob/v1.0.0/src/server/migrations/scripts/restoreDatabase.sh" target="_blank" rel="noopener noreferrer">restoreDatabase.sh</a></ul><h2>Running the first script</h2><p>The first script is called <code>dumpDatabase.sh</code> and it should be in the main OED directory after the steps above. Run the script in the main OED directory by running the command:<br> <code>bash dumpDatabase.sh</code><br><p>The script will then run the first steps of the database migration, eventually prompting the user to reset the passwords for the database users oed and postgres. It will display the passwords that it should be reset to based on the environment variables, and the user must enter it in twice and make sure that no error messages occur. It is okay to copy the password shown and paste it into the requested password. Afterwards, the script will create a database dump file called <code>script_database_dump.sql</code> in the main OED directory where the script was run from.<h2>Shutting down OED</h2><p>The first script requires OED to be running but the second script requires OED to be shut down. Please shut down OED before running the next script. See the step in the <a href="../adminUpgrading/">admin upgrading page</a> for details on doing this.<h2>Running the second script</h2><p>The second script is called <code>restoreDatabase.sh</code> and it should be in the main OED directory after the steps above. Run the script in the main OED directory by running the command:<br> <code>bash restoreDatabase.sh</code><br><p>The second script will remove the postgres version 10.13 database container and bring up a container with postgres version 15.3. It will restore the dump to the new database container and bring it back down again, leaving OED in a shut down state. This can take a couple of minutes. After script finishes running successfully, the database migration is complete. If you are asked about descending and/or removing a write protected directory (postgres-data) then you should answer 'y' (without the quotes).<h2>Removing files</h2><p>This process created three files that are no longer needed. To keep your software directory clean and to save space, it is best to remove them before continuing with a standard upgrade. Do the following in a terminal/shell in the main OED directory:<br> <code>rm dumpDatabase.sh restoreDatabase.sh script_database_dump.sql</code><br> Note that not doing this could cause a git merge issue when you do the rest of the upgrade.<h2>Continuing upgrade</h2><p> At this point you can continue the <a href="../adminUpgrading/">standard upgrade process from the next step.</a></div></div></article></div></div><div id="up-to-top" class="row"><div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a></div></div><footer id="footer-content" class="bg-grau"><div id="footer"><div class="row"> <noscript><div class="alert-box warning "><p>Some aspect of this site will not work and others will work better if you enable JavaScript.</div></noscript></div><div class="row"><div class="medium-6 large-5 columns"><h5 class="shadow-black">About This Site</h5><p class="shadow-black"> The OED dashboard allows organization to acquire, archive, analyze and display energy/resource usage. <a href="https://openenergydashboard.org/features/">More ›</a></div><div class="small-6 medium-3 large-3 large-offset-1 columns"><h5 class="shadow-black">Services</h5><ul class="no-bullet shadow-black"><li > <a href="https://openenergydashboard.org/" title=""></a><li > <a href="https://openenergydashboard.org/contact/" title="Contact">Contact</a><li > <a href="https://openenergydashboard.org/sitemap.xml" title="Sitemap for Google Webmaster Tools">sitemap.xml</a></ul></div><div class="small-6 medium-3 large-3 columns"><ul class="no-bullet shadow-black"></ul></div></div></div><div id="subfooter"><nav class="row"><section id="subfooter-left" class="small-12 medium-6 columns credits"><p>Created by the OED team using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> based on <a href="https://phlow.github.io/feeling-responsive/">Feeling Responsive</a>. This page is part of the Open Energy Dashboard and is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, you can obtain one at <a href="https://www.mozilla.org/en-US/MPL/2.0/" rel="nofollow">https://www.mozilla.org/en-US/MPL/2.0/</a>.</section><section id="subfooter-right" class="small-12 medium-6 columns"><ul class="inline-list social-icons"><li><a href="https://github.com/OpenEnergyDashboard/OED" target="_blank" class="icon-github" title="Code other repos..."></a></ul></section></nav></div></footer><script src="https://openenergydashboard.org/assets/js/javascript.min.js"></script>
