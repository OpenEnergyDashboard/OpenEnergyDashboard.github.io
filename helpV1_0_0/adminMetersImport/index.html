<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Meter Import Doc</title><link rel="stylesheet" type="text/css" href="https://openenergydashboard.org/assets/css/styles_feeling_responsive.css"> <script src="https://openenergydashboard.org/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <noscript><link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'> </noscript><meta name="description" content="Version V1.0.0 Documentation overview Admin documentation Information Overview Standard Units Pages Units &amp; Conversions Site Management Conversion Creating Conversion Editing Conversion Viewing Group Creating Group Editing Group Map Creating Map Viewing Meter Creating Meter Editing Meter Viewing Site Settings Unit Creating Unit Editing Unit Viewing User Data Acquisition CSV Import Data Acquisition eGauge MAMAC Meter Import Reading Import Site Installation Production Install Output Installation Directions Upgrades Upgrades V1.0.0 User documentation User help Documentation versions for this page V1.0.0 (current page) V0.8.0 V0.7.0 These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user. Overview This page describes the process of importing meters into OED via a CSV file. See the general CSV import page for an overview and information common to all CSV imports. Usage The information needed to upload meters is the same whether done via the web page or direct file upload. The web page looks as follows: Required and optional information The user name and password is required in the direct file upload as described on the general CSV import page. It is automatically provided on the web page upload since you are logged in. CSV file (&quot;Choose File&quot; button on web page; csvFile parameter on direct file upload): This gives the location of the CSV file containing the meter information. On the web page it is via a file picker popup. See below on the file format. Is CSV file in gzip format (&quot;Gzip&quot; checked if yes on web page; gzip parameter on direct file upload with default value of yes. ): Note this is the Gnu zip format and not a standard .zip file format. Note that gzip files are smaller in size for upload and also have internal validation to protect against corruption so they are preferred. Does CSV have a header row (&quot;Header Row&quot; checked if yes on web page; headerRow parameter on direct file upload): Is the first row of the CSV file header information and not an actual meter (see below for format). The default value is no. Is this an update (&quot;Update&quot; checked if yes on web page; update parameter on direct file upload): Each row is new information for the meter so it will be update with any provided values and others are left as currently set. The default value is no. Meter name (&quot;Meter name&quot; input box on web page; meterName parameter on direct file upload): This is only used if you want to change the name of a meter (not identifier). The meter name provided is used as the name to update and the meter name value in the CSV is used as the new name. Note you can only update a single meter name at a time meaning that the CSV can only have one row of meter information. Meter CSV file format Meters in OED store a lot of information about them so there are many possible values. If the CSV file has a header row then it should be: name,url,enabled,displayable,type,timezone,gps,identifier,note,area,cumulative,reset,reset start,reset end,gap,variation,duplicates,timesort,end only,reading,start time,end time,previous end,unit,default graphic unit,area unit,reading freq. Currently OED does not use the header row so the names are not crucial but OED may do so in the future so using these column header names is a good idea. Detailed information on the columns/values are described on the admin meter creating page. The order of the items is somewhat different than those specified for the header row above. Each following line should contain the values for one meter in exactly the order listed for the header row example above. The column can be blank where the default value for OED will be used if the meter creation information does not indicate it is required. Information needed for CSV upload compared to the meter creation page information are: When providing a unit one should use the name, e.g., &quot;kWh&quot;. When providing a value for &quot;type&quot; one should use ones in the drop down menu on the meter creation page, e.g, &quot;OBVIUS&quot;. This is case-sensitive. When providing a value for &quot;timesort&quot; use the dropdown menu options of &quot;increasing&quot; and &quot;decreasing&quot;. This is case-sensitive. If no value is provided then the meter is created with the default of increasing. When inputting the area unit use &quot;feet&quot; or &quot;meters&quot; (Do not include &quot;sq.&quot;). When providing a value for the &quot;timezone&quot; use the name from the dropdown menu, e.g., &quot;Pacific/Galapagos&quot;. Many spreadsheet programs automatically format text that looks like a time or date into a different format. In general, to avoid this, one should set those fields to be text rather than a time or date. If this is not done then you will likely get a format error or unexpected data when you upload a CSV file. If you upload a CSV that has missing or incorrect values then it could cause issues. However, some values will be noted with red boxes when you edit this meter and then it can be corrected. For example, if you put in an area but not a unit this will happen. If you have any doubts then it is a good idea to look at the values on the meters page to verify they are what you wanted. Sample file Below are the lines for a CSV meter import file with a header row and available in this meters.csv file. It will import two meters (Meter 1 and My Place (identifier) or Meter 2 (name)) where the meters are not enabled but are displayable. Please note that &quot;3,5&quot; is a pair of values separated by a comma that would be in a single column of the CSV file and input without the quotes, i.e., 3,5. The quotes are added when such a CSV is saved to make it clear that the comma is not a new column. Most values that are optional and unspecified so the default values are used for Meter 1 but are provided for the second meter. Also note that values that are &quot;yes&quot; on dropdown menus for meter creation must be &quot;true&quot; and values that are &quot;no&quot; must be &quot;false&quot; in this file (but not the curl command). This file can be loaded using the curl command of: curl https://myoedserver.com:3000/api/csv/meters -X POST -F &#39;headerRow=yes&#39; -F &#39;gzip=no&#39; -F &#39;email=csvuser@myorg.com&#39; -F &#39;password=csvuserpassword&#39; -F &#39;csvfile=@meters.csv&#39; assuming the shown URL, user email and password. (See admin reading sample files for more information on URL, email and password.) You need to reload the OED web page so your browser is aware of the new meters after a curl import but you will get an empty graphic if used since they don&#39;t have any data yet. name,url,enabled,displayable,type,timezone,gps,identifier,note,area,cumulative,reset,reset start,reset end,gap,variation,duplicates,timesort,end only,reading,start time,end time,previous end,unit,default graphic unit,area unit,reading freq. Meter 1,,false,yes,other,,,,,,,,,,,,,,,,,,,Electric_Utility,,, Meter 2,127.0.0.0,false,true,obvius,Pacific/Galapagos,&quot;3,5&quot;,My Place,special note,123,true,true,11:50,12:10,5,10,2,decreasing,true,,,,,Electric_Utility,kWh,meters,13:00 Return messages What follows are the common messages returned from a meter upload along with their meaning: &amp;lt;h1&amp;gt;SUCCESS&amp;lt;/h1&gt;Successfully inserted the meters. &amp;lt;h1&amp;gt;FAILURE&amp;lt;/h1&amp;gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name of pipe41 seems to exist when inserting new meters and got DB error of: duplicate key value violates unique constraint &quot;meters_name_key&quot; This normally happens when the name (or similarly identifier) of the meter already exists. It may be the case that you wanted to update this meter but did not specify this. &amp;lt;h1&amp;gt;FAILURE&amp;lt;/h1&amp;gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name of pipe42 does not seem to exist with update for meters and got DB error of: No data returned from the query. Request indicated to update meter(s) but at least one did not exist. All meters must exist on update. &amp;lt;h1&amp;gt;SUCCESS&amp;lt;/h1&amp;gt;Successfully inserted the meters.&amp;lt;h1&amp;gt;FAILURE&amp;lt;/h1&amp;gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name provided (pipe40) in request with update for meters but more than one meter in CSV so not processing When you want to change a meter name you specify the name in the request as well as the CSV file. It then uses the name in the request to find the meter and the value in the CSV as the new meter name. However, you can only have a single meter in the CSV file for this to work. This indicates more than one meter was provided. You can get a variety of error messages if the gzip is improperly set. These include &quot;TypeError&quot;, &quot;invalid message format&quot; and others. This is because OED is incorrectly reading the CSV file and receives garbled information. Details See meters after CSV uploaded via direct file upload You need to reload your web browser pages as described here."><meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ"><meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" ><link rel="canonical" href="https://openenergydashboard.org/helpV1_0_0/adminMetersImport/"><meta property="og:title" content="Meter Import Doc"><meta property="og:description" content="Version V1.0.0 Documentation overview Admin documentation Information Overview Standard Units Pages Units &amp; Conversions Site Management Conversion Creating Conversion Editing Conversion Viewing Group Creating Group Editing Group Map Creating Map Viewing Meter Creating Meter Editing Meter Viewing Site Settings Unit Creating Unit Editing Unit Viewing User Data Acquisition CSV Import Data Acquisition eGauge MAMAC Meter Import Reading Import Site Installation Production Install Output Installation Directions Upgrades Upgrades V1.0.0 User documentation User help Documentation versions for this page V1.0.0 (current page) V0.8.0 V0.7.0 These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user. Overview This page describes the process of importing meters into OED via a CSV file. See the general CSV import page for an overview and information common to all CSV imports. Usage The information needed to upload meters is the same whether done via the web page or direct file upload. The web page looks as follows: Required and optional information The user name and password is required in the direct file upload as described on the general CSV import page. It is automatically provided on the web page upload since you are logged in. CSV file (&quot;Choose File&quot; button on web page; csvFile parameter on direct file upload): This gives the location of the CSV file containing the meter information. On the web page it is via a file picker popup. See below on the file format. Is CSV file in gzip format (&quot;Gzip&quot; checked if yes on web page; gzip parameter on direct file upload with default value of yes. ): Note this is the Gnu zip format and not a standard .zip file format. Note that gzip files are smaller in size for upload and also have internal validation to protect against corruption so they are preferred. Does CSV have a header row (&quot;Header Row&quot; checked if yes on web page; headerRow parameter on direct file upload): Is the first row of the CSV file header information and not an actual meter (see below for format). The default value is no. Is this an update (&quot;Update&quot; checked if yes on web page; update parameter on direct file upload): Each row is new information for the meter so it will be update with any provided values and others are left as currently set. The default value is no. Meter name (&quot;Meter name&quot; input box on web page; meterName parameter on direct file upload): This is only used if you want to change the name of a meter (not identifier). The meter name provided is used as the name to update and the meter name value in the CSV is used as the new name. Note you can only update a single meter name at a time meaning that the CSV can only have one row of meter information. Meter CSV file format Meters in OED store a lot of information about them so there are many possible values. If the CSV file has a header row then it should be: name,url,enabled,displayable,type,timezone,gps,identifier,note,area,cumulative,reset,reset start,reset end,gap,variation,duplicates,timesort,end only,reading,start time,end time,previous end,unit,default graphic unit,area unit,reading freq. Currently OED does not use the header row so the names are not crucial but OED may do so in the future so using these column header names is a good idea. Detailed information on the columns/values are described on the admin meter creating page. The order of the items is somewhat different than those specified for the header row above. Each following line should contain the values for one meter in exactly the order listed for the header row example above. The column can be blank where the default value for OED will be used if the meter creation information does not indicate it is required. Information needed for CSV upload compared to the meter creation page information are: When providing a unit one should use the name, e.g., &quot;kWh&quot;. When providing a value for &quot;type&quot; one should use ones in the drop down menu on the meter creation page, e.g, &quot;OBVIUS&quot;. This is case-sensitive. When providing a value for &quot;timesort&quot; use the dropdown menu options of &quot;increasing&quot; and &quot;decreasing&quot;. This is case-sensitive. If no value is provided then the meter is created with the default of increasing. When inputting the area unit use &quot;feet&quot; or &quot;meters&quot; (Do not include &quot;sq.&quot;). When providing a value for the &quot;timezone&quot; use the name from the dropdown menu, e.g., &quot;Pacific/Galapagos&quot;. Many spreadsheet programs automatically format text that looks like a time or date into a different format. In general, to avoid this, one should set those fields to be text rather than a time or date. If this is not done then you will likely get a format error or unexpected data when you upload a CSV file. If you upload a CSV that has missing or incorrect values then it could cause issues. However, some values will be noted with red boxes when you edit this meter and then it can be corrected. For example, if you put in an area but not a unit this will happen. If you have any doubts then it is a good idea to look at the values on the meters page to verify they are what you wanted. Sample file Below are the lines for a CSV meter import file with a header row and available in this meters.csv file. It will import two meters (Meter 1 and My Place (identifier) or Meter 2 (name)) where the meters are not enabled but are displayable. Please note that &quot;3,5&quot; is a pair of values separated by a comma that would be in a single column of the CSV file and input without the quotes, i.e., 3,5. The quotes are added when such a CSV is saved to make it clear that the comma is not a new column. Most values that are optional and unspecified so the default values are used for Meter 1 but are provided for the second meter. Also note that values that are &quot;yes&quot; on dropdown menus for meter creation must be &quot;true&quot; and values that are &quot;no&quot; must be &quot;false&quot; in this file (but not the curl command). This file can be loaded using the curl command of: curl https://myoedserver.com:3000/api/csv/meters -X POST -F &#39;headerRow=yes&#39; -F &#39;gzip=no&#39; -F &#39;email=csvuser@myorg.com&#39; -F &#39;password=csvuserpassword&#39; -F &#39;csvfile=@meters.csv&#39; assuming the shown URL, user email and password. (See admin reading sample files for more information on URL, email and password.) You need to reload the OED web page so your browser is aware of the new meters after a curl import but you will get an empty graphic if used since they don&#39;t have any data yet. name,url,enabled,displayable,type,timezone,gps,identifier,note,area,cumulative,reset,reset start,reset end,gap,variation,duplicates,timesort,end only,reading,start time,end time,previous end,unit,default graphic unit,area unit,reading freq. Meter 1,,false,yes,other,,,,,,,,,,,,,,,,,,,Electric_Utility,,, Meter 2,127.0.0.0,false,true,obvius,Pacific/Galapagos,&quot;3,5&quot;,My Place,special note,123,true,true,11:50,12:10,5,10,2,decreasing,true,,,,,Electric_Utility,kWh,meters,13:00 Return messages What follows are the common messages returned from a meter upload along with their meaning: &amp;lt;h1&amp;gt;SUCCESS&amp;lt;/h1&gt;Successfully inserted the meters. &amp;lt;h1&amp;gt;FAILURE&amp;lt;/h1&amp;gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name of pipe41 seems to exist when inserting new meters and got DB error of: duplicate key value violates unique constraint &quot;meters_name_key&quot; This normally happens when the name (or similarly identifier) of the meter already exists. It may be the case that you wanted to update this meter but did not specify this. &amp;lt;h1&amp;gt;FAILURE&amp;lt;/h1&amp;gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name of pipe42 does not seem to exist with update for meters and got DB error of: No data returned from the query. Request indicated to update meter(s) but at least one did not exist. All meters must exist on update. &amp;lt;h1&amp;gt;SUCCESS&amp;lt;/h1&amp;gt;Successfully inserted the meters.&amp;lt;h1&amp;gt;FAILURE&amp;lt;/h1&amp;gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name provided (pipe40) in request with update for meters but more than one meter in CSV so not processing When you want to change a meter name you specify the name in the request as well as the CSV file. It then uses the name in the request to find the meter and the value in the CSV as the new meter name. However, you can only have a single meter in the CSV file for this to work. This indicates more than one meter was provided. You can get a variety of error messages if the gzip is improperly set. These include &quot;TypeError&quot;, &quot;invalid message format&quot; and others. This is because OED is incorrectly reading the CSV file and receives garbled information. Details See meters after CSV uploaded via direct file upload You need to reload your web browser pages as described here."><meta property="og:url" content="https://openenergydashboard.org/helpV1_0_0/adminMetersImport/"><meta property="og:locale" content="en_EN"><meta property="og:type" content="website"><meta property="og:site_name" content="Open Energy Dashboard"><link rel="icon" sizes="32x32" href="https://openenergydashboard.org/assets/img/OEDIcon22x32.png"><link rel="icon" sizes="192x192" href="https://openenergydashboard.org/assets/img/OEDIcon192x274.png"><body id="top-of-page" class="page-fullwidth"><div id="navigation" class="sticky"><nav class="top-bar" role="navigation" data-topbar data-options="scrolltop: false"><ul class="title-area"><li class="name"><h1 class="hide-for-large-up"><a href="https://openenergydashboard.org/" class="icon-tree"> Open Energy Dashboard</a></h1><li class="toggle-topbar toggle-topbar-click menu-icon"><a><span>Nav</span></a></ul><section class="top-bar-section"><ul class="left"><li><a href="https://openenergydashboard.org/">home</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/features/">features</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/features/">features by type</a><li><a href="https://openenergydashboard.org/useAcademic/">features by academic use</a></ul><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/helpV1_0_0/user/">Documentation</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/helpV1_0_0/user/">oed version 1.0.0</a><li><a href="https://openenergydashboard.org/helpV0_8_0/user/">oed version 0.8.0</a><li><a href="https://openenergydashboard.org/helpV0_7_0/user/">oed version 0.7.0</a><li><a href="https://openenergydashboard.org/helpV0_6_0/user/">oed version 0.6.0</a></ul><li class="divider"><li><a href="https://openenergydashboard.org/use/">Adopting</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/news/">info</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/news/">news</a><li><a href="https://openenergydashboard.org/principles/">project principles</a><li><a href="https://openenergydashboard.org/free/">free &amp; maintained</a><li><a href="https://openenergydashboard.org/mission/">mission</a><li><a href="https://openenergydashboard.org/why/">why exists</a><li><a href="https://openenergydashboard.org/projectInfo/">project information pages &amp; license</a><li><a href="https://openenergydashboard.org/name/">why OED name, logo &amp; some history</a></ul><li class="divider"></ul><ul class="right"><li class="divider"><li><a href="https://openenergydashboard.org/search/">Search</a><li class="divider"><li><a href="https://openenergydashboard.org/contact/">Contact</a><li class="divider"><li><a href="https://openenergydashboard.org/developer/developer/">developer docs</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/involved/">get involved</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/internship/">becoming a developer</a><li><a href="https://openenergydashboard.org/studentExperience/">student experience</a></ul></ul></section></nav></div><div id="masthead-no-image-header"><div class="row"><div class="small-6 small-centered columns"> <a id="logo" title="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard"> <img src="https://openenergydashboard.org/assets/img/logoHelp.png" alt="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard"> </a></div></div></div><nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs"> <a href="https://openenergydashboard.org/">Start</a> <a href="https://openenergydashboard.org/helpV1_0_0/">helpV1_0_0</a> <a class="current">Meter Import</a></nav><div class="row t15"><div class="medium-12 columns"><article><header><p class="subheadline">OED Documentation<h1>Meter Import</h1></header><div class="row"><p>Version V1.0.0<div class="medium-4 medium-push-8 columns" markdown="1"><div class="panel radius" markdown="1"><div style="list-style: none;" class="side-nav"><h4><a href='../admin/'>Documentation overview</a></h4><div><h5>Admin documentation</h5><div style="padding-left: 1em;"><h6>Information</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/admin/">Overview</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminOedUnits/">Standard Units</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminPageChoices/">Pages</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitInfo/">Units & Conversions</a></br></div></div><div style="padding-left: 1em;"><h6>Site Management</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionCreating/">Conversion Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionEditing/">Conversion Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionViewing/">Conversion Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupCreating/">Group Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupEditing/">Group Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupViewing/">Group</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapCreating/">Map Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapViewing/">Map Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterCreating/">Meter Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterEditing/">Meter Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterViewing/">Meter Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminPreferences/">Site Settings</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitCreating/">Unit Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitEditing/">Unit Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitViewing/">Unit Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUser/">User</a></br></div></div><div style="padding-left: 1em;"><h6>Data Acquisition</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminCsvImport/">CSV Import</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminDataAcquisition/">Data Acquisition</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminEgauge/">eGauge</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMamac/">MAMAC</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMetersImport/">Meter Import</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminReadingsImport/">Reading Import</a></br></div></div><div style="padding-left: 1em;"><h6>Site Installation</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminInstallOutput/">Production Install Output</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminInstallation/">Installation Directions</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgrading/">Upgrades</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgradingV1/">Upgrades V1.0.0</a></br></div></div><h5>User documentation</h5><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminMetersImport/../user/">User help</a></br></div><h5>Documentation versions for this page</h5><div style="padding-left: 1em;"> V1.0.0 (current page)</br> <a href="../../helpV0_8_0/adminMetersImport/">V0.8.0</a></br> <a href="../../helpV0_7_0/adminMetersImport/">V0.7.0</a></br></div></div></div></div></div><div class="medium-8 medium-pull-4 columns" markdown="1"><div class="alert-box info "><p>These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user.</div><h2 id="overview">Overview</h2><p>This page describes the process of importing meters into OED via a CSV file. See the <a href="../adminCsvImport/">general CSV import</a> page for an overview and information common to all CSV imports.<h2 id="usage">Usage</h2><p>The information needed to upload meters is the same whether done via the web page or direct file upload. The web page looks as follows: <img alt="admin CSV meter page" src="../images/adminMeterCSV.png"><p><h3>Required and optional information</h3><ul><li>The user name and password is required in the direct file upload as described on the <a href="../adminCsvImport/">general CSV import</a> page. It is automatically provided on the web page upload since you are logged in.<li><i>CSV file ("Choose File" button on web page; <code>csvFile</code> parameter on direct file upload)</i>: This gives the location of the CSV file containing the meter information. On the web page it is via a file picker popup. See below on the file format.<li><i>Is CSV file in gzip format ("Gzip" checked if yes on web page; <code>gzip</code> parameter on direct file upload with default value of yes. )</i>: Note this is the Gnu zip format and not a standard .zip file format. Note that gzip files are smaller in size for upload and also have internal validation to protect against corruption so they are preferred.<li><i>Does CSV have a header row ("Header Row" checked if yes on web page; <code>headerRow</code> parameter on direct file upload)</i>: Is the first row of the CSV file header information and not an actual meter (see below for format). The default value is no.<li><i>Is this an update ("Update" checked if yes on web page; <code>update</code> parameter on direct file upload)</i>: Each row is new information for the meter so it will be update with any provided values and others are left as currently set. The default value is no.<li><i>Meter name ("Meter name" input box on web page; <code>meterName</code> parameter on direct file upload)</i>: This is only used if you want to change the name of a meter (not identifier). The meter name provided is used as the name to update and the meter name value in the CSV is used as the new name. Note you can only update a single meter name at a time meaning that the CSV can only have one row of meter information.</ul><h3>Meter CSV file format</h3><p>Meters in OED store a lot of information about them so there are many possible values. If the CSV file has a header row then it should be:<br> name,url,enabled,displayable,type,timezone,gps,identifier,note,area,cumulative,reset,reset start,reset end,gap,variation,duplicates,timesort,end only,reading,start time,end time,previous end,unit,default graphic unit,area unit,reading freq.<br> Currently OED does not use the header row so the names are not crucial but OED may do so in the future so using these column header names is a good idea. Detailed information on the columns/values are described on the <a href="../adminMeterCreating/">admin meter creating</a> page. The order of the items is somewhat different than those specified for the header row above. Each following line should contain the values for one meter in exactly the order listed for the header row example above. The column can be blank where the default value for OED will be used if the meter creation information does not indicate it is required. Information needed for CSV upload compared to the meter creation page information are:<ul><li>When providing a unit one should use the name, e.g., "kWh".<li>When providing a value for "type" one should use ones in the drop down menu on the meter creation page, e.g, "OBVIUS". This is case-sensitive.<li>When providing a value for "timesort" use the dropdown menu options of "increasing" and "decreasing". This is case-sensitive. If no value is provided then the meter is created with the default of increasing.<li>When inputting the area unit use "feet" or "meters" (Do not include "sq.").<li>When providing a value for the "timezone" use the name from the dropdown menu, e.g., "Pacific/Galapagos".</ul><p>Many spreadsheet programs automatically format text that looks like a time or date into a different format. In general, to avoid this, one should set those fields to be text rather than a time or date. If this is not done then you will likely get a format error or unexpected data when you upload a CSV file.<p>If you upload a CSV that has missing or incorrect values then it could cause issues. However, some values will be noted with red boxes when you edit this meter and then it can be corrected. For example, if you put in an area but not a unit this will happen. If you have any doubts then it is a good idea to look at the values on the meters page to verify they are what you wanted.<h3>Sample file</h3><p>Below are the lines for a CSV meter import file with a header row and available in this <a href="../files/meters.csv" download>meters.csv</a> file. It will import two meters (Meter 1 and My Place (identifier) or Meter 2 (name)) where the meters are not enabled but are displayable. Please note that "3,5" is a pair of values separated by a comma that would be in a single column of the CSV file and input without the quotes, i.e., 3,5. The quotes are added when such a CSV is saved to make it clear that the comma is not a new column. Most values that are optional and unspecified so the default values are used for Meter 1 but are provided for the second meter. Also note that values that are "yes" on dropdown menus for meter creation must be "true" and values that are "no" must be "false" in this file (but not the curl command). This file can be loaded using the curl command of:<br> <code>curl https://myoedserver.com:3000/api/csv/meters -X POST -F 'headerRow=yes' -F 'gzip=no' -F 'email=csvuser@myorg.com' -F 'password=csvuserpassword' -F 'csvfile=@meters.csv'</code><br> assuming the shown URL, user email and password. (See <a href="../adminReadingsImport/#sampleFiles">admin reading sample files</a> for more information on URL, email and password.) You need to reload the OED web page so your browser is aware of the new meters after a curl import but you will get an empty graphic if used since they don't have any data yet.<pre>
        name,url,enabled,displayable,type,timezone,gps,identifier,note,area,cumulative,reset,reset start,reset end,gap,variation,duplicates,timesort,end only,reading,start time,end time,previous end,unit,default graphic unit,area unit,reading freq.
        Meter 1,,false,yes,other,,,,,,,,,,,,,,,,,,,Electric_Utility,,,
        Meter 2,127.0.0.0,false,true,obvius,Pacific/Galapagos,"3,5",My Place,special note,123,true,true,11:50,12:10,5,10,2,decreasing,true,,,,,Electric_Utility,kWh,meters,13:00
    </pre><h3>Return messages</h3><p>What follows are the common messages returned from a meter upload along with their meaning:<ul><li><code>&lt;h1&gt;SUCCESS&lt;/h1>Successfully inserted the meters.</code><li> <code>&lt;h1&gt;FAILURE&lt;/h1&gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name of pipe41 seems to exist when inserting new meters and got DB error of: duplicate key value violates unique constraint "meters_name_key"</code><br> This normally happens when the name (or similarly identifier) of the meter already exists. It may be the case that you wanted to update this meter but did not specify this.<li> <code>&lt;h1&gt;FAILURE&lt;/h1&gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name of pipe42 does not seem to exist with update for meters and got DB error of: No data returned from the query.</code><br> Request indicated to update meter(s) but at least one did not exist. All meters must exist on update.<li> <code>&lt;h1&gt;SUCCESS&lt;/h1&gt;Successfully inserted the meters.&lt;h1&gt;FAILURE&lt;/h1&gt;CSVPipelineError: Failed to upload meters due to internal OED Error: Meter name provided (pipe40) in request with update for meters but more than one meter in CSV so not processing</code><br> When you want to change a meter name you specify the name in the request as well as the CSV file. It then uses the name in the request to find the meter and the value in the CSV as the new meter name. However, you can only have a single meter in the CSV file for this to work. This indicates more than one meter was provided.<li>You can get a variety of error messages if the gzip is improperly set. These include "TypeError", "invalid message format" and others. This is because OED is incorrectly reading the CSV file and receives garbled information.</ul><h2 id="details">Details</h2><h3>See meters after CSV uploaded via direct file upload</h3><p>You need to reload your web browser pages as described <a href="../adminCsvImport/#reload">here</a>.</div></div></article></div></div><div id="up-to-top" class="row"><div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a></div></div><footer id="footer-content" class="bg-grau"><div id="footer"><div class="row"> <noscript><div class="alert-box warning "><p>Some aspect of this site will not work and others will work better if you enable JavaScript.</div></noscript></div><div class="row"><div class="medium-6 large-5 columns"><h5 class="shadow-black">About This Site</h5><p class="shadow-black"> The OED dashboard allows organization to acquire, archive, analyze and display energy/resource usage. <a href="https://openenergydashboard.org/features/">More ›</a></div><div class="small-6 medium-3 large-3 large-offset-1 columns"><h5 class="shadow-black">Services</h5><ul class="no-bullet shadow-black"><li > <a href="https://openenergydashboard.org/" title=""></a><li > <a href="https://openenergydashboard.org/contact/" title="Contact">Contact</a><li > <a href="https://openenergydashboard.org/sitemap.xml" title="Sitemap for Google Webmaster Tools">sitemap.xml</a></ul></div><div class="small-6 medium-3 large-3 columns"><ul class="no-bullet shadow-black"></ul></div></div></div><div id="subfooter"><nav class="row"><section id="subfooter-left" class="small-12 medium-6 columns credits"><p>Created by the OED team using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> based on <a href="https://phlow.github.io/feeling-responsive/">Feeling Responsive</a>. This page is part of the Open Energy Dashboard and is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, you can obtain one at <a href="https://www.mozilla.org/en-US/MPL/2.0/" rel="nofollow">https://www.mozilla.org/en-US/MPL/2.0/</a>.</section><section id="subfooter-right" class="small-12 medium-6 columns"><ul class="inline-list social-icons"><li><a href="https://github.com/OpenEnergyDashboard/OED" target="_blank" class="icon-github" title="Code other repos..."></a></ul></section></nav></div></footer><script src="https://openenergydashboard.org/assets/js/javascript.min.js"></script>
