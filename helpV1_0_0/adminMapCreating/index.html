<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Map Creating Doc</title><link rel="stylesheet" type="text/css" href="https://openenergydashboard.org/assets/css/styles_feeling_responsive.css"> <script src="https://openenergydashboard.org/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <noscript><link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'> </noscript><meta name="description" content="Version V1.0.0 Documentation overview Admin documentation Information Overview Standard Units Pages Units &amp; Conversions Site Management Conversion Creating Conversion Editing Conversion Viewing Group Creating Group Editing Group Map Creating Map Viewing Meter Creating Meter Editing Meter Viewing Site Settings Unit Creating Unit Editing Unit Viewing User Data Acquisition CSV Import Data Acquisition eGauge MAMAC Meter Import Reading Import Site Installation Production Install Output Installation Directions Upgrades Upgrades V1.0.0 User documentation User help Documentation versions for this page V1.0.0 (current page) These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user. Overview See the map graphic page for general information on OED and maps. Note that unlike many systems, using maps in OED does not require any additional software nor the use of GIS. Instead, you load a graphical image you want to use as a map. This can be anything from a real map, a stylized graphic with buildings and features of interest to an arbitrary graphic. Once loaded, you calibrate this map by informing OED about a few GPS coordinates for items on the map. OED will automatically allow users to place meters on a graph as long as you have input the GPS data for that meter. OED allows sites to have as many maps as they wish and maps can overlap. For example, you could have maps with two different sites and a map that zooms in to show details of one of the sites. This greatly simplified system is based on a simple assumption that the map is flat. In actuality, the world is a sphere so that it is curved. However, over modest distances, it is effectively flat. This is why local maps don&#39;t appear warped but ones of the entire global make some areas look much larger than they really are. Since most maps involving a site are over very modest distances this works very well. If you want a large geographical area map then see circle placement below on making this work. Note that you can have different maps that are very far apart without any issue. It is only a single map covering a large area that causes issues. For this system to work, OED needs to know the rotation of each map from true north. This allows OED to align the real world longitude and latitude (used in GPS) with the map graphic. OED internally stores this rotation as the angle from true north on the map graphic to straight up on the map graphic going in the counterclockwise direction. OED can then use this angle to properly calibrate the map and place items on the map (see below). Usage The admin map page allows admin users to see all information on maps on an OED site. It is accessed from the &quot;Pages&quot; dropdown menu by clicking &quot;Maps&quot; as shown in the following figure (highlighted in the blue rectangle where &quot;Maps&quot; is grayed out since it has already been clicked). This shows the page when two maps are on the site. Click the blue &quot;Create a Map&quot; button to begin the process of uploading a map to see the page in the next figure. Click on the &quot;Choose File&quot; button (highlighted with a blue box) to open a standard web browser popup to select a file. Choose the graphical image of the map. Note the image can be of types JPEG or PNG (the file extension does not matter but the contents must be one of these two image types). OED will allow one to choose other types of files and will state the upload is complete but the file image does not appear on the next step. There are many programs/apps to convert to one of these two types of graphical images. Note that a non-rectangular map that does not have horizontal/vertical edges will be forced into this rectangular shape by OED and parts of the map may be clipped off. After selecting the map image file, use the box immediately below (labeled &quot;Define a name for the map:&quot;) to name the map. Note this is the name that a user will see (it can be edited later). The name must be a different name than any other map. If a duplicate name is used then the final saving of the map after calibration will fail (notification given) and the process will have to be repeated. In this example, &quot;Happy Place&quot; was used. (The happyPlace.png image file used.) Finally, input the angle of the map relative to true north. To properly display maps, OED needs to know the vector that points to true north on the uploaded map. This is the clockwise angle between straight up on the map image uploaded and true north. See the discussion on true north angle below for setting this value on a rotated map (angle is not zero). In this example 0 (zero) was used. When ready, click the &quot;Save and continue&quot; button to complete this step. The confirmation popup that appears is shown below. Click &quot;OK&quot; to continue the process. The map calibration page should appear and is shown below. This page allows the entry of the GPS coordinates for places on the map so OED can map locations on the map to locations on the globe (world map). Place the curser (appears as a &quot;+&quot; symbol) at the point on the map with known GPS coordinate. As the mouse moves, the x and y coordinates on the map grid change and span from 0-300 in the x-direction and 0-500 in the y-direction. These can be less depending on the aspect ratio of the map since they might be clipped in one direction to make the map fit the grid coordinate system. It is fine to zoom in on a part of the map to allow a finer control and placement of the mouse. In the figure below, the cursor was placed at grid coordinate (277, 461) and then the mouse was clicked. (Unfortunately the image cannot pick up the &quot;+&quot; where the cursor was located.) This point was chosen since in a real situation the GPS coordinate for the top, right corner of the &quot;Swimming Pool&quot; building in the image is (277, 461). As shown in the figure above, when that point was clicked, a message appeared below the map (inside the blue box used for highlighting) that says &quot;input GPS coordinate that corresponds to the point: x: 277, y: 461 in this format -&gt; latitude,longitude&quot;. This confirms that the coordinate clicked was (277, 461). As the message states, one needs to enter the GPS coordinate for this point on the map as a latitude, longitude pair separated by a comma. This is a common format for GPS coordinates but do not include parentheses when you enter the GPS value such as they are written above. Enter the GPS value in the box below this message. For this example, the GPS coordinate entered was 40.00461, -87.99723. The box where this was entered is shown in the next figure. Once complete, click the &quot;Submit&quot; button below the box for GPS. This leads to the figure below. The text at the bottom of the web browser window, &quot;result: Need more points&quot; (highlighted with a blue box) indicates the result. It is stating that there are too few points to complete the calibration. OED needs a minimum of three points to calculate the error and possibly complete the calibration. Also note that the message will change the GPS coordinate to &quot;undefined&quot; so it becomes &quot;input GPS coordinate that corresponds to the point: undefined in this format -&gt; latitude,longitude&quot; after a point is submitted. This is to indicate that a new point has yet to be chosen. Now repeat the steps above to enter more calibration points. Click anywhere on the map where the GPS coordinates are known. It is okay to click more than once to replace the point clicked with a new one as long as it is before &quot;Submit&quot; is clicked. See below for suggestions on points to use and how to get the GPS coordinates for points on the map. The other two values used in this example are: top, left corner of Cafeteria (34, 238) with GPS of 40.00238, -87.99966 bottom, left corner of Housing (100, 35) with GPS of 40.00034, -87.99901 Once at least three calibration points are entered, OED will give an estimate of the overall calibration result as shown in the figure below. In this example, the result is &quot;result: x: 1.202% y: 0.25%&quot;. (Note the points used were deliberately shifted a little bit so a small error is shown.) If satisfied with the result, click the &quot;Save changes to database&quot; button. The result is shown in the next figure where there is now three maps including the one just added. Note that when leaving the page displaying all maps that OED will ask if you want to save changes or not. This is because a new map was added and OED cannot tell the difference between a new map and changes to an existing map&#39;s information. It is safe to either leave without changes if no other maps were changed or to save to be careful to leave this page. See below for a discussion of the Calibration Result. If at any time one wants to begin the calibration process again, click the &quot;Reset&quot; button. If the calibration is a little worse than desired, try to add more points to improve the error but this is not guaranteed to work. Once the calibration is saved, the Admin Map Viewing page is shown again. If users should to be able to see the map then make sure &quot;Display Enabled&quot; is shown. It is best to verify that items are showing up in the correct places before the map is revealed to users so it will be disabled after map calibration. A map can be re-calibrated from this page. There are other values one can set and see that are described on the Admin Map Viewing page. Once the GPS of a meter is set, it can be seen on the map as long as it lies within the map. (See the map graphing page for more information.) If the circle is not showing up at the desired points or is not present, then see the section on circle placement issues below. This process can be repeated for as many maps as desired. If the following meters are created and supplied with reading: Play Place with GPS of 40.00419, -87.99916 Theater with GPS of 40.0027, -87.9975 Mapping these two meters on the Happy Place map would yield what is shown in the following figure. True north angle To properly display maps, OED needs to know the vector that points to true north on the uploaded map. This is the clockwise angle between straight up on the map image and true north. If the map image is oriented to north at the top then the angle is 0. If not, the angle needs to be determined. For example, suppose the Happy Place map used above was rotated 30 degrees clockwise. This would give the following image: Let&#39;s assume the original map was oriented to true north. The arrow labeled true north shows this direction. The other arrow labeled straight up points directly to to top of the image (and is parallel to the corresponding sides of the image). The pink arrow labeled angle is the angle between the two arrows and the direction indicates the direction of the OED needed angle. In this case the angle is 30 degrees from straight up to true north. One would enter this value for the angle when inputting the map. Note that the GPS coordinates entered for any meter or group is the actual one and is not changed by this rotation angle. Note that normally the map image is rectangular and oriented to how people view the organization in this map. Thus, the map image is not normally rotated and was done here for example purposes. Instead, use the angle to tell OED what is going on. So, how can one get the angle needed? Sometimes the person or group that created the image of your organization knows this value, esp. if it was created with a GIS system. If not, one can use a mapping program on the web (such as Google Maps). These generally put true north at the top. If you take a screenshot of the area on the mapping program used, one can then rotate the image until it aligns with the one you want to upload into OED. The angle that you needed to rotate the map is the value OED needs. Please note that some graphics programs/descriptions rotate the image and some rotate the coordinate system so care should be taken when getting the value from a graphics program. These values are just negatives of each other so checking if it follows the image above tells if it needs to be negated the angle value. If the graphing does not produce the desired result, one may need to adjust this angle. Note that OED expects an angle between 0 and 360 so if the angle is negative adding 360 to make it positive will be the correct value. Choosing calibration points and finding the GPS value OED uses the distance between calibration points to determine the quality of the points (called the &quot;result&quot; above). Spreading the points around the map increases the distance between the points. This is more likely to lead to correct placement of points around the entire map. If possible this should be done but not if it means using less accurate GPS values for each calibration point entered. The GPS value of the calibration points can be determined in any way. A way that is often accurate and easy is to use an online mapping site that contains an image that shows the same points that are contained in the map image used in OED. Then click on that point on the map to get the GPS value. While OED does not endorse any particular online map, a popular one is Google Maps. With this one can right click on any point on a map to reveal information about that point. The first one is the GPS coordinates. If one left clicks on the GPS coordinate it will copy it to the clipboard. Then paste this value into the OED box to input GPS coordinates during the calibration steps described above. Another technique is to physically go to the point on the map and use a cell phone application that shows the current GPS location. Whatever technique used, it is important to get accurate values so the calibration is of high quality. Calibration result OED gives a result that provides an idea of how far off the calibration points are from each other. This gives an idea of how accurately OED will place circles on the map. For example, three calibration points were entered on the map above where each one was changed by +/- 0.0001, which changes in the 6th digit. This was done so the first calibration point had latitude and longitude increased by this amount, the second decreased by this amount and the third had latitude increased and longitude decreased by this amount. As such, it was somewhat random if the value increased or decreased. These changes were done by using the &quot;Calibrate&quot; button on the admin map viewing page so the map did not have to be reloaded into OED. The values used for the map calibration were: top, right corner of Swimming Pool (277, 461) with GPS of 40.00471, -87.99713 top, left corner of Cafeteria (34, 238) with GPS of 40.00228, -87.99976 bottom, left corner of Housing (100, 35) with GPS of 40.00044, -87.99911 This lead to a result of &quot;result: 7.259%, y: 9.312%&quot;. Compared to the map above with the more accurate calibration points, the circles in the following figure have moved a little but are in the correct general place. If the each value is changed +/- 0.001 as done above then the result is much worse. The values used for the map calibration were: top, right corner of Swimming Pool (277, 461) with GPS of 40.00561, -87.99623 top, left corner of Cafeteria (34, 238) with GPS of 40.00138, -88.00066 bottom, left corner of Housing (100, 35) with GPS of 40.00134, -88.00001 The result is &quot;result: 40.234%, y: 97.975%&quot;. The result of mapping is shown in the next figure where both are noticeably off. If the change was increased even further then the circles would shift even more and might eventually be off the map. When placement is poor, the map needs to be re-calibrated. Note that the error may not always indicate how poor placement will be. If every point was shifted a positive amount of +0.001 then OED will not find an additional calibration error due to the systematic shift but items placed on the map will be changed (assuming there is no a similar error in where meters are located). The values used for the map calibration were: top, right corner of Swimming Pool (277, 461) with GPS of 40.00561, -87.99623 top, left corner of Cafeteria (34, 238) with GPS of 40.00338, -87.99866 bottom, left corner of Housing (100, 35) with GPS of 40.00134, -87.99801 This example gives a result of &quot;result: 1.202%, y: 0.25%&quot; which is the same small error as the original example. The resulting map graphic is shown in the next figure. Here the &quot;Play Place&quot; meter is no longer on the map. There are many possible reasons that the calibration might be off and we discuss several now. First, it is easy to type in the wrong value for a point. If this happens then correctly reentering the calibration values again will fix the issue. Second, a value for a calibration point is wrong. While a similar result to the first issue, it means rechecking each point to see which one(s) might be off. Third, the accuracy of the points is too low. This requires using another technique to get the values. This can happen, for example, if the map used to get the GPS coordinates has features placed at a different location than on the map you uploaded to OED. It could also happen because manually read GPS values (such as going to a place and using the value shown of a cell phone) are off. This is due to the inherent accuracy of the device in getting the GPS coordinate or standing in the correct location. Finally, it is possible that the true north angle is off. This will generally lead to items not showing up on the map and/or being off across all meters/groups. While many issues can happen, the OED project found that getting the correct value is usually possible and led to good placement on the map. Getting a good calibration is the easiest way to place items on the map. See the next section for ideas on fixing poor placement of the circles on the map. Circle placement issues If the best possible has been done to calibrate the map but circle(s) are still in the wrong place then fixing them manually in the meter GPS value is an option. OED only uses the GPS value for placing items on maps so fudging this value does not have other consequences or lead to incorrect results. This is usually easiest if the circles are reasonably close to the desired location on the map. Going back to the first calibration error example where it was +/-0.0001, it is seen that both meters are a little low on the map. Looking at GPS values for this map indicates that as the latitude gets larger the placement goes up (and as the longitude gets smaller (more negative) the placement goes left). Given small changes in GPS value can have large effects on a small map, the latitude was changed by +0.0005 so the new meter values are: Play Place with GPS of 40.00469, -87.99916 Theater with GPS of 40.0032, -87.9975 By using the Admin Map Viewing page, the GPS values were changed. This moved both meters much too far up. Next a latitude shift (from the original values) of +0.00007 was tried so the new values used were: Play Place with GPS of 40.00426, -87.99916 Theater with GPS of 40.00277, -87.9975 This was still too high but much better as shown in the next figure. Finally, the latitude was shifted by +0.000015 to give: Play Place with GPS of 40.004205, -87.99916 Theater with GPS of 40.002715, -87.9975 This was pretty good as shown in the next figure. Some more adjustment could have been made if desired. This does show that very small changes in GPS values can have large shifts on a small map. One thing to note is that this process is only done once when a new map is loaded. After that, any user will see the correct result. Also, once you move one point on the map it becomes clearer the amount needed for other circles so it usually takes less time. There are circumstance that can make it impossible to modify the meter GPS to get it in the correct place on the map. One is if the needed correction means the GPS value goes outside allowed values then OED will not allow the entry of this GPS value. This should only happen if the calibration is off significantly and should be rectified if the map calibration is redone with greater accuracy. A second is if two maps overlap in area so changing the GPS of a meter causes one map to be fine but another now has it in the wrong place. Proper calibration is the solution in this case. Details While all these examples were for meters, the same ideas apply equally to groups."><meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ"><meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" ><link rel="canonical" href="https://openenergydashboard.org/helpV1_0_0/adminMapCreating/"><meta property="og:title" content="Map Creating Doc"><meta property="og:description" content="Version V1.0.0 Documentation overview Admin documentation Information Overview Standard Units Pages Units &amp; Conversions Site Management Conversion Creating Conversion Editing Conversion Viewing Group Creating Group Editing Group Map Creating Map Viewing Meter Creating Meter Editing Meter Viewing Site Settings Unit Creating Unit Editing Unit Viewing User Data Acquisition CSV Import Data Acquisition eGauge MAMAC Meter Import Reading Import Site Installation Production Install Output Installation Directions Upgrades Upgrades V1.0.0 User documentation User help Documentation versions for this page V1.0.0 (current page) These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user. Overview See the map graphic page for general information on OED and maps. Note that unlike many systems, using maps in OED does not require any additional software nor the use of GIS. Instead, you load a graphical image you want to use as a map. This can be anything from a real map, a stylized graphic with buildings and features of interest to an arbitrary graphic. Once loaded, you calibrate this map by informing OED about a few GPS coordinates for items on the map. OED will automatically allow users to place meters on a graph as long as you have input the GPS data for that meter. OED allows sites to have as many maps as they wish and maps can overlap. For example, you could have maps with two different sites and a map that zooms in to show details of one of the sites. This greatly simplified system is based on a simple assumption that the map is flat. In actuality, the world is a sphere so that it is curved. However, over modest distances, it is effectively flat. This is why local maps don&#39;t appear warped but ones of the entire global make some areas look much larger than they really are. Since most maps involving a site are over very modest distances this works very well. If you want a large geographical area map then see circle placement below on making this work. Note that you can have different maps that are very far apart without any issue. It is only a single map covering a large area that causes issues. For this system to work, OED needs to know the rotation of each map from true north. This allows OED to align the real world longitude and latitude (used in GPS) with the map graphic. OED internally stores this rotation as the angle from true north on the map graphic to straight up on the map graphic going in the counterclockwise direction. OED can then use this angle to properly calibrate the map and place items on the map (see below). Usage The admin map page allows admin users to see all information on maps on an OED site. It is accessed from the &quot;Pages&quot; dropdown menu by clicking &quot;Maps&quot; as shown in the following figure (highlighted in the blue rectangle where &quot;Maps&quot; is grayed out since it has already been clicked). This shows the page when two maps are on the site. Click the blue &quot;Create a Map&quot; button to begin the process of uploading a map to see the page in the next figure. Click on the &quot;Choose File&quot; button (highlighted with a blue box) to open a standard web browser popup to select a file. Choose the graphical image of the map. Note the image can be of types JPEG or PNG (the file extension does not matter but the contents must be one of these two image types). OED will allow one to choose other types of files and will state the upload is complete but the file image does not appear on the next step. There are many programs/apps to convert to one of these two types of graphical images. Note that a non-rectangular map that does not have horizontal/vertical edges will be forced into this rectangular shape by OED and parts of the map may be clipped off. After selecting the map image file, use the box immediately below (labeled &quot;Define a name for the map:&quot;) to name the map. Note this is the name that a user will see (it can be edited later). The name must be a different name than any other map. If a duplicate name is used then the final saving of the map after calibration will fail (notification given) and the process will have to be repeated. In this example, &quot;Happy Place&quot; was used. (The happyPlace.png image file used.) Finally, input the angle of the map relative to true north. To properly display maps, OED needs to know the vector that points to true north on the uploaded map. This is the clockwise angle between straight up on the map image uploaded and true north. See the discussion on true north angle below for setting this value on a rotated map (angle is not zero). In this example 0 (zero) was used. When ready, click the &quot;Save and continue&quot; button to complete this step. The confirmation popup that appears is shown below. Click &quot;OK&quot; to continue the process. The map calibration page should appear and is shown below. This page allows the entry of the GPS coordinates for places on the map so OED can map locations on the map to locations on the globe (world map). Place the curser (appears as a &quot;+&quot; symbol) at the point on the map with known GPS coordinate. As the mouse moves, the x and y coordinates on the map grid change and span from 0-300 in the x-direction and 0-500 in the y-direction. These can be less depending on the aspect ratio of the map since they might be clipped in one direction to make the map fit the grid coordinate system. It is fine to zoom in on a part of the map to allow a finer control and placement of the mouse. In the figure below, the cursor was placed at grid coordinate (277, 461) and then the mouse was clicked. (Unfortunately the image cannot pick up the &quot;+&quot; where the cursor was located.) This point was chosen since in a real situation the GPS coordinate for the top, right corner of the &quot;Swimming Pool&quot; building in the image is (277, 461). As shown in the figure above, when that point was clicked, a message appeared below the map (inside the blue box used for highlighting) that says &quot;input GPS coordinate that corresponds to the point: x: 277, y: 461 in this format -&gt; latitude,longitude&quot;. This confirms that the coordinate clicked was (277, 461). As the message states, one needs to enter the GPS coordinate for this point on the map as a latitude, longitude pair separated by a comma. This is a common format for GPS coordinates but do not include parentheses when you enter the GPS value such as they are written above. Enter the GPS value in the box below this message. For this example, the GPS coordinate entered was 40.00461, -87.99723. The box where this was entered is shown in the next figure. Once complete, click the &quot;Submit&quot; button below the box for GPS. This leads to the figure below. The text at the bottom of the web browser window, &quot;result: Need more points&quot; (highlighted with a blue box) indicates the result. It is stating that there are too few points to complete the calibration. OED needs a minimum of three points to calculate the error and possibly complete the calibration. Also note that the message will change the GPS coordinate to &quot;undefined&quot; so it becomes &quot;input GPS coordinate that corresponds to the point: undefined in this format -&gt; latitude,longitude&quot; after a point is submitted. This is to indicate that a new point has yet to be chosen. Now repeat the steps above to enter more calibration points. Click anywhere on the map where the GPS coordinates are known. It is okay to click more than once to replace the point clicked with a new one as long as it is before &quot;Submit&quot; is clicked. See below for suggestions on points to use and how to get the GPS coordinates for points on the map. The other two values used in this example are: top, left corner of Cafeteria (34, 238) with GPS of 40.00238, -87.99966 bottom, left corner of Housing (100, 35) with GPS of 40.00034, -87.99901 Once at least three calibration points are entered, OED will give an estimate of the overall calibration result as shown in the figure below. In this example, the result is &quot;result: x: 1.202% y: 0.25%&quot;. (Note the points used were deliberately shifted a little bit so a small error is shown.) If satisfied with the result, click the &quot;Save changes to database&quot; button. The result is shown in the next figure where there is now three maps including the one just added. Note that when leaving the page displaying all maps that OED will ask if you want to save changes or not. This is because a new map was added and OED cannot tell the difference between a new map and changes to an existing map&#39;s information. It is safe to either leave without changes if no other maps were changed or to save to be careful to leave this page. See below for a discussion of the Calibration Result. If at any time one wants to begin the calibration process again, click the &quot;Reset&quot; button. If the calibration is a little worse than desired, try to add more points to improve the error but this is not guaranteed to work. Once the calibration is saved, the Admin Map Viewing page is shown again. If users should to be able to see the map then make sure &quot;Display Enabled&quot; is shown. It is best to verify that items are showing up in the correct places before the map is revealed to users so it will be disabled after map calibration. A map can be re-calibrated from this page. There are other values one can set and see that are described on the Admin Map Viewing page. Once the GPS of a meter is set, it can be seen on the map as long as it lies within the map. (See the map graphing page for more information.) If the circle is not showing up at the desired points or is not present, then see the section on circle placement issues below. This process can be repeated for as many maps as desired. If the following meters are created and supplied with reading: Play Place with GPS of 40.00419, -87.99916 Theater with GPS of 40.0027, -87.9975 Mapping these two meters on the Happy Place map would yield what is shown in the following figure. True north angle To properly display maps, OED needs to know the vector that points to true north on the uploaded map. This is the clockwise angle between straight up on the map image and true north. If the map image is oriented to north at the top then the angle is 0. If not, the angle needs to be determined. For example, suppose the Happy Place map used above was rotated 30 degrees clockwise. This would give the following image: Let&#39;s assume the original map was oriented to true north. The arrow labeled true north shows this direction. The other arrow labeled straight up points directly to to top of the image (and is parallel to the corresponding sides of the image). The pink arrow labeled angle is the angle between the two arrows and the direction indicates the direction of the OED needed angle. In this case the angle is 30 degrees from straight up to true north. One would enter this value for the angle when inputting the map. Note that the GPS coordinates entered for any meter or group is the actual one and is not changed by this rotation angle. Note that normally the map image is rectangular and oriented to how people view the organization in this map. Thus, the map image is not normally rotated and was done here for example purposes. Instead, use the angle to tell OED what is going on. So, how can one get the angle needed? Sometimes the person or group that created the image of your organization knows this value, esp. if it was created with a GIS system. If not, one can use a mapping program on the web (such as Google Maps). These generally put true north at the top. If you take a screenshot of the area on the mapping program used, one can then rotate the image until it aligns with the one you want to upload into OED. The angle that you needed to rotate the map is the value OED needs. Please note that some graphics programs/descriptions rotate the image and some rotate the coordinate system so care should be taken when getting the value from a graphics program. These values are just negatives of each other so checking if it follows the image above tells if it needs to be negated the angle value. If the graphing does not produce the desired result, one may need to adjust this angle. Note that OED expects an angle between 0 and 360 so if the angle is negative adding 360 to make it positive will be the correct value. Choosing calibration points and finding the GPS value OED uses the distance between calibration points to determine the quality of the points (called the &quot;result&quot; above). Spreading the points around the map increases the distance between the points. This is more likely to lead to correct placement of points around the entire map. If possible this should be done but not if it means using less accurate GPS values for each calibration point entered. The GPS value of the calibration points can be determined in any way. A way that is often accurate and easy is to use an online mapping site that contains an image that shows the same points that are contained in the map image used in OED. Then click on that point on the map to get the GPS value. While OED does not endorse any particular online map, a popular one is Google Maps. With this one can right click on any point on a map to reveal information about that point. The first one is the GPS coordinates. If one left clicks on the GPS coordinate it will copy it to the clipboard. Then paste this value into the OED box to input GPS coordinates during the calibration steps described above. Another technique is to physically go to the point on the map and use a cell phone application that shows the current GPS location. Whatever technique used, it is important to get accurate values so the calibration is of high quality. Calibration result OED gives a result that provides an idea of how far off the calibration points are from each other. This gives an idea of how accurately OED will place circles on the map. For example, three calibration points were entered on the map above where each one was changed by +/- 0.0001, which changes in the 6th digit. This was done so the first calibration point had latitude and longitude increased by this amount, the second decreased by this amount and the third had latitude increased and longitude decreased by this amount. As such, it was somewhat random if the value increased or decreased. These changes were done by using the &quot;Calibrate&quot; button on the admin map viewing page so the map did not have to be reloaded into OED. The values used for the map calibration were: top, right corner of Swimming Pool (277, 461) with GPS of 40.00471, -87.99713 top, left corner of Cafeteria (34, 238) with GPS of 40.00228, -87.99976 bottom, left corner of Housing (100, 35) with GPS of 40.00044, -87.99911 This lead to a result of &quot;result: 7.259%, y: 9.312%&quot;. Compared to the map above with the more accurate calibration points, the circles in the following figure have moved a little but are in the correct general place. If the each value is changed +/- 0.001 as done above then the result is much worse. The values used for the map calibration were: top, right corner of Swimming Pool (277, 461) with GPS of 40.00561, -87.99623 top, left corner of Cafeteria (34, 238) with GPS of 40.00138, -88.00066 bottom, left corner of Housing (100, 35) with GPS of 40.00134, -88.00001 The result is &quot;result: 40.234%, y: 97.975%&quot;. The result of mapping is shown in the next figure where both are noticeably off. If the change was increased even further then the circles would shift even more and might eventually be off the map. When placement is poor, the map needs to be re-calibrated. Note that the error may not always indicate how poor placement will be. If every point was shifted a positive amount of +0.001 then OED will not find an additional calibration error due to the systematic shift but items placed on the map will be changed (assuming there is no a similar error in where meters are located). The values used for the map calibration were: top, right corner of Swimming Pool (277, 461) with GPS of 40.00561, -87.99623 top, left corner of Cafeteria (34, 238) with GPS of 40.00338, -87.99866 bottom, left corner of Housing (100, 35) with GPS of 40.00134, -87.99801 This example gives a result of &quot;result: 1.202%, y: 0.25%&quot; which is the same small error as the original example. The resulting map graphic is shown in the next figure. Here the &quot;Play Place&quot; meter is no longer on the map. There are many possible reasons that the calibration might be off and we discuss several now. First, it is easy to type in the wrong value for a point. If this happens then correctly reentering the calibration values again will fix the issue. Second, a value for a calibration point is wrong. While a similar result to the first issue, it means rechecking each point to see which one(s) might be off. Third, the accuracy of the points is too low. This requires using another technique to get the values. This can happen, for example, if the map used to get the GPS coordinates has features placed at a different location than on the map you uploaded to OED. It could also happen because manually read GPS values (such as going to a place and using the value shown of a cell phone) are off. This is due to the inherent accuracy of the device in getting the GPS coordinate or standing in the correct location. Finally, it is possible that the true north angle is off. This will generally lead to items not showing up on the map and/or being off across all meters/groups. While many issues can happen, the OED project found that getting the correct value is usually possible and led to good placement on the map. Getting a good calibration is the easiest way to place items on the map. See the next section for ideas on fixing poor placement of the circles on the map. Circle placement issues If the best possible has been done to calibrate the map but circle(s) are still in the wrong place then fixing them manually in the meter GPS value is an option. OED only uses the GPS value for placing items on maps so fudging this value does not have other consequences or lead to incorrect results. This is usually easiest if the circles are reasonably close to the desired location on the map. Going back to the first calibration error example where it was +/-0.0001, it is seen that both meters are a little low on the map. Looking at GPS values for this map indicates that as the latitude gets larger the placement goes up (and as the longitude gets smaller (more negative) the placement goes left). Given small changes in GPS value can have large effects on a small map, the latitude was changed by +0.0005 so the new meter values are: Play Place with GPS of 40.00469, -87.99916 Theater with GPS of 40.0032, -87.9975 By using the Admin Map Viewing page, the GPS values were changed. This moved both meters much too far up. Next a latitude shift (from the original values) of +0.00007 was tried so the new values used were: Play Place with GPS of 40.00426, -87.99916 Theater with GPS of 40.00277, -87.9975 This was still too high but much better as shown in the next figure. Finally, the latitude was shifted by +0.000015 to give: Play Place with GPS of 40.004205, -87.99916 Theater with GPS of 40.002715, -87.9975 This was pretty good as shown in the next figure. Some more adjustment could have been made if desired. This does show that very small changes in GPS values can have large shifts on a small map. One thing to note is that this process is only done once when a new map is loaded. After that, any user will see the correct result. Also, once you move one point on the map it becomes clearer the amount needed for other circles so it usually takes less time. There are circumstance that can make it impossible to modify the meter GPS to get it in the correct place on the map. One is if the needed correction means the GPS value goes outside allowed values then OED will not allow the entry of this GPS value. This should only happen if the calibration is off significantly and should be rectified if the map calibration is redone with greater accuracy. A second is if two maps overlap in area so changing the GPS of a meter causes one map to be fine but another now has it in the wrong place. Proper calibration is the solution in this case. Details While all these examples were for meters, the same ideas apply equally to groups."><meta property="og:url" content="https://openenergydashboard.org/helpV1_0_0/adminMapCreating/"><meta property="og:locale" content="en_EN"><meta property="og:type" content="website"><meta property="og:site_name" content="Open Energy Dashboard"><link rel="icon" sizes="32x32" href="https://openenergydashboard.org/assets/img/OEDIcon22x32.png"><link rel="icon" sizes="192x192" href="https://openenergydashboard.org/assets/img/OEDIcon192x274.png"><body id="top-of-page" class="page-fullwidth"><div id="navigation" class="sticky"><nav class="top-bar" role="navigation" data-topbar data-options="scrolltop: false"><ul class="title-area"><li class="name"><h1 class="hide-for-large-up"><a href="https://openenergydashboard.org/" class="icon-tree"> Open Energy Dashboard</a></h1><li class="toggle-topbar toggle-topbar-click menu-icon"><a><span>Nav</span></a></ul><section class="top-bar-section"><ul class="left"><li><a href="https://openenergydashboard.org/">home</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/features/">features</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/features/">features by type</a><li><a href="https://openenergydashboard.org/useAcademic/">features by academic use</a></ul><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/helpV1_0_0/user/">Documentation</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/helpV1_0_0/user/">oed version 1.0.0</a><li><a href="https://openenergydashboard.org/helpV0_8_0/user/">oed version 0.8.0</a><li><a href="https://openenergydashboard.org/helpV0_7_0/user/">oed version 0.7.0</a><li><a href="https://openenergydashboard.org/helpV0_6_0/user/">oed version 0.6.0</a></ul><li class="divider"><li><a href="https://openenergydashboard.org/use/">Adopting</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/news/">info</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/news/">news</a><li><a href="https://openenergydashboard.org/principles/">project principles</a><li><a href="https://openenergydashboard.org/free/">free &amp; maintained</a><li><a href="https://openenergydashboard.org/mission/">mission</a><li><a href="https://openenergydashboard.org/why/">why exists</a><li><a href="https://openenergydashboard.org/projectInfo/">project information pages &amp; license</a><li><a href="https://openenergydashboard.org/name/">why OED name, logo &amp; some history</a></ul><li class="divider"></ul><ul class="right"><li class="divider"><li><a href="https://openenergydashboard.org/search/">Search</a><li class="divider"><li><a href="https://openenergydashboard.org/contact/">Contact</a><li class="divider"><li><a href="https://openenergydashboard.org/developer/developer/">developer docs</a><li class="divider"><li class="has-dropdown"> <a href="https://openenergydashboard.org/involved/">get involved</a><ul class="dropdown"><li><a href="https://openenergydashboard.org/internship/">becoming a developer</a><li><a href="https://openenergydashboard.org/studentExperience/">student experience</a></ul></ul></section></nav></div><div id="masthead-no-image-header"><div class="row"><div class="small-6 small-centered columns"> <a id="logo" title="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard"> <img src="https://openenergydashboard.org/assets/img/logoHelp.png" alt="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard"> </a></div></div></div><nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs"> <a href="https://openenergydashboard.org/">Start</a> <a href="https://openenergydashboard.org/helpV1_0_0/">helpV1_0_0</a> <a class="current">Map Creating</a></nav><div class="row t15"><div class="medium-12 columns"><article><header><p class="subheadline">OED Documentation<h1>Map Creating</h1></header><div class="row"><p>Version V1.0.0<div class="medium-4 medium-push-8 columns" markdown="1"><div class="panel radius" markdown="1"><div style="list-style: none;" class="side-nav"><h4><a href='../admin/'>Documentation overview</a></h4><div><h5>Admin documentation</h5><div style="padding-left: 1em;"><h6>Information</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/admin/">Overview</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminOedUnits/">Standard Units</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminPageChoices/">Pages</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitInfo/">Units & Conversions</a></br></div></div><div style="padding-left: 1em;"><h6>Site Management</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionCreating/">Conversion Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionEditing/">Conversion Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminConversionViewing/">Conversion Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupCreating/">Group Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupEditing/">Group Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminGroupViewing/">Group</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapCreating/">Map Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapViewing/">Map Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterCreating/">Meter Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterEditing/">Meter Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMeterViewing/">Meter Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminPreferences/">Site Settings</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitCreating/">Unit Creating</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitEditing/">Unit Editing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUnitViewing/">Unit Viewing</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUser/">User</a></br></div></div><div style="padding-left: 1em;"><h6>Data Acquisition</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminCsvImport/">CSV Import</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminDataAcquisition/">Data Acquisition</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminEgauge/">eGauge</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMamac/">MAMAC</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminMetersImport/">Meter Import</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminReadingsImport/">Reading Import</a></br></div></div><div style="padding-left: 1em;"><h6>Site Installation</h6><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminInstallOutput/">Production Install Output</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminInstallation/">Installation Directions</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgrading/">Upgrades</a></br> <a href="https://openenergydashboard.org/helpV1_0_0/adminUpgradingV1/">Upgrades V1.0.0</a></br></div></div><h5>User documentation</h5><div style="padding-left: 1em;"> <a href="https://openenergydashboard.org/helpV1_0_0/adminMapCreating/../user/">User help</a></br></div><h5>Documentation versions for this page</h5><div style="padding-left: 1em;"> V1.0.0 (current page)</br></div></div></div></div></div><div class="medium-8 medium-pull-4 columns" markdown="1"><div class="alert-box info "><p>These features are only available to select people who oversee the OED site (called admins) so this information is not usually of interest to a general user.</div><h2 id="overview">Overview</h2><p>See the <a href="../mapGraphic/">map graphic page</a> for general information on OED and maps. Note that unlike many systems, using maps in OED does not require any additional software nor the use of GIS. Instead, you load a graphical image you want to use as a map. This can be anything from a real map, a stylized graphic with buildings and features of interest to an arbitrary graphic. Once loaded, you calibrate this map by informing OED about a few GPS coordinates for items on the map. OED will automatically allow users to place meters on a graph as long as you have <a href="../adminMeterViewing/">input the GPS data for that meter</a>. OED allows sites to have as many maps as they wish and maps can overlap. For example, you could have maps with two different sites and a map that zooms in to show details of one of the sites.<p>This greatly simplified system is based on a simple assumption that the map is flat. In actuality, the world is a sphere so that it is curved. However, over modest distances, it is effectively flat. This is why local maps don't appear warped but ones of the entire global make some areas look much larger than they really are. Since most maps involving a site are over very modest distances this works very well. If you want a large geographical area map then see <a href="#circlePlacementIssues">circle placement below</a> on making this work. Note that you can have different maps that are very far apart without any issue. It is only a single map covering a large area that causes issues.<p>For this system to work, OED needs to know the rotation of each map from true north. This allows OED to align the real world longitude and latitude (used in GPS) with the map graphic. OED internally stores this rotation as the angle from true north on the map graphic to straight up on the map graphic going in the counterclockwise direction. OED can then use this angle to properly calibrate the map and place items on the map (see below).<h2 id="usage">Usage</h2><p>The admin map page allows admin users to see all information on maps on an OED site. It is accessed from the <a href="../pageChoices/">"Pages" dropdown menu</a> by clicking "Maps" as shown in the following figure (highlighted in the blue rectangle where "Maps" is grayed out since it has already been clicked). <img alt="Admin map page" src="../images/adminMapPage.png"><p>This shows the page when two maps are on the site. Click the blue "Create a Map" button to begin the process of uploading a map to see the page in the next figure. Click on the "Choose File" button (highlighted with a blue box) to open a standard web browser popup to select a file. Choose the graphical image of the map. Note the image can be of types JPEG or PNG (the file extension does not matter but the contents must be one of these two image types). OED will allow one to choose other types of files and will state the upload is complete but the file image does not appear on the next step. There are many programs/apps to convert to one of these two types of graphical images. Note that a non-rectangular map that does not have horizontal/vertical edges will be forced into this rectangular shape by OED and parts of the map may be clipped off. After selecting the map image file, use the box immediately below (labeled "Define a name for the map:") to name the map. Note this is the name that a user will see (it can be edited later). The name must be a different name than any other map. If a duplicate name is used then the final saving of the map after calibration will fail (notification given) and the process will have to be repeated. In this example, "Happy Place" was used. (The <a href="../files/happyPlace.png">happyPlace.png</a> image file used.) Finally, input the angle of the map relative to true north. To properly display maps, OED needs to know the vector that points to true north on the uploaded map. This is the clockwise angle between straight up on the map image uploaded and true north. See the discussion on <a href="#angle">true north angle</a> below for setting this value on a rotated map (angle is not zero). In this example 0 (zero) was used. When ready, click the "Save and continue" button to complete this step. <img alt="admin map loading page" src="../images/adminLoadMap.png"><p>The confirmation popup that appears is shown below. Click "OK" to continue the process. <img alt="admin map loading completion popup" src="../images/adminMapUploadComplete.png" width="431"><p>The map calibration page should appear and is shown below. This page allows the entry of the GPS coordinates for places on the map so OED can map locations on the map to locations on the globe (world map). Place the curser (appears as a "+" symbol) at the point on the map with known GPS coordinate. As the mouse moves, the x and y coordinates on the map grid change and span from 0-300 in the x-direction and 0-500 in the y-direction. These can be less depending on the aspect ratio of the map since they might be clipped in one direction to make the map fit the grid coordinate system. It is fine to zoom in on a part of the map to allow a finer control and placement of the mouse. In the figure below, the cursor was placed at grid coordinate (277, 461) and then the mouse was clicked. (Unfortunately the image cannot pick up the "+" where the cursor was located.) This point was chosen since in a real situation the GPS coordinate for the top, right corner of the "Swimming Pool" building in the image is (277, 461). <img alt="admin map calibration point entry" src="../images/adminMapCalibrationStepOne.png"><p>As shown in the figure above, when that point was clicked, a message appeared below the map (inside the blue box used for highlighting) that says "input GPS coordinate that corresponds to the point: x: 277, y: 461 in this format -> latitude,longitude". This confirms that the coordinate clicked was (277, 461). As the message states, one needs to enter the GPS coordinate for this point on the map as a latitude, longitude pair separated by a comma. This is a common format for GPS coordinates but do not include parentheses when you enter the GPS value such as they are written above. Enter the GPS value in the box below this message. For this example, the GPS coordinate entered was 40.00461, -87.99723. The box where this was entered is shown in the next figure. <img alt="admin map calibration point entry" src="../images/adminMapCalibrationStepTwo.png" width="372"><p>Once complete, click the "Submit" button below the box for GPS. This leads to the figure below. The text at the bottom of the web browser window, "result: Need more points" (highlighted with a blue box) indicates the result. It is stating that there are too few points to complete the calibration. OED needs a minimum of three points to calculate the error and possibly complete the calibration. Also note that the message will change the GPS coordinate to "undefined" so it becomes "input GPS coordinate that corresponds to the point: undefined in this format -> latitude,longitude" after a point is submitted. This is to indicate that a new point has yet to be chosen. <img alt="admin map showing need more calibration points" src="../images/adminMapCalibrationStepThree.png"><p>Now repeat the steps above to enter more calibration points. Click anywhere on the map where the GPS coordinates are known. It is okay to click more than once to replace the point clicked with a new one as long as it is before "Submit" is clicked. See below for <a href="#calibrationPoints">suggestions on points to use and how to get the GPS coordinates</a> for points on the map. The other two values used in this example are:<ul><li>top, left corner of Cafeteria (34, 238) with GPS of 40.00238, -87.99966<li>bottom, left corner of Housing (100, 35) with GPS of 40.00034, -87.99901</ul><p>Once at least three calibration points are entered, OED will give an estimate of the overall calibration result as shown in the figure below. <img alt="admin map showing result of current calibration points" src="../images/adminMapCalibrationStepFour.png" width="372"><p>In this example, the result is "result: x: 1.202% y: 0.25%". (Note the points used were deliberately shifted a little bit so a small error is shown.) If satisfied with the result, click the "Save changes to database" button. The result is shown in the next figure where there is now three maps including the one just added. Note that when leaving the page displaying all maps that OED will ask if you want to save changes or not. This is because a new map was added and OED cannot tell the difference between a new map and changes to an existing map's information. It is safe to either leave without changes if no other maps were changed or to save to be careful to leave this page. See below for a discussion of the <a href="#calibrationResult">Calibration Result</a>. If at any time one wants to begin the calibration process again, click the "Reset" button. If the calibration is a little worse than desired, try to add more points to improve the error but this is not guaranteed to work. Once the calibration is saved, the <a href="../adminMapViewing/">Admin Map Viewing</a> page is shown again. If users should to be able to see the map then make sure "Display Enabled" is shown. It is best to verify that items are showing up in the correct places before the map is revealed to users so it will be disabled after map calibration. A map can be re-calibrated from this page. There are other values one can set and see that are described on the <a href="../adminMapViewing/">Admin Map Viewing</a> page. <img alt="admin map viewing page after calibration" src="../images/adminMapViewingAfterCalibration.png"><p>Once the GPS of a meter is set, it can be seen on the map as long as it lies within the map. (See the <a href="../mapGraphic/">map graphing</a> page for more information.) If the circle is not showing up at the desired points or is not present, then see the section on <a href="#circlePlacementIssues">circle placement issues</a> below.<p>This process can be repeated for as many maps as desired.<p>If the following meters are created and supplied with reading:<ul><li>Play Place with GPS of 40.00419, -87.99916<li>Theater with GPS of 40.0027, -87.9975</ul><p>Mapping these two meters on the Happy Place map would yield what is shown in the following figure. <img alt="Happy Place map with two meters" src="../images/adminHappyPlace.png"><h3 id="angle">True north angle</h3><p>To properly display maps, OED needs to know the vector that points to true north on the uploaded map. This is the clockwise angle between straight up on the map image and true north. If the map image is oriented to north at the top then the angle is 0. If not, the angle needs to be determined. For example, suppose the Happy Place map used above was rotated 30 degrees clockwise. This would give the following image: <img alt="Happy Place map rotated 30 degrees with up and true north vectors along with angle between" src="../images/HappyPlace30Deg.png" width="237"><p>Let's assume the original map was oriented to true north. The arrow labeled true north shows this direction. The other arrow labeled straight up points directly to to top of the image (and is parallel to the corresponding sides of the image). The pink arrow labeled angle is the angle between the two arrows and the direction indicates the direction of the OED needed angle. In this case the angle is 30 degrees from straight up to true north. One would enter this value for the angle when inputting the map. Note that the GPS coordinates entered for any meter or group is the actual one and is not changed by this rotation angle.<p>Note that normally the map image is rectangular and oriented to how people view the organization in this map. Thus, the map image is not normally rotated and was done here for example purposes. Instead, use the angle to tell OED what is going on.<p>So, how can one get the angle needed? Sometimes the person or group that created the image of your organization knows this value, esp. if it was created with a GIS system. If not, one can use a mapping program on the web (such as Google Maps). These generally put true north at the top. If you take a screenshot of the area on the mapping program used, one can then rotate the image until it aligns with the one you want to upload into OED. The angle that you needed to rotate the map is the value OED needs. Please note that some graphics programs/descriptions rotate the image and some rotate the coordinate system so care should be taken when getting the value from a graphics program. These values are just negatives of each other so checking if it follows the image above tells if it needs to be negated the angle value. If the graphing does not produce the desired result, one may need to adjust this angle. Note that OED expects an angle between 0 and 360 so if the angle is negative adding 360 to make it positive will be the correct value.<h3 id="calibrationPoints">Choosing calibration points and finding the GPS value</h3><p>OED uses the distance between calibration points to determine the quality of the points (called the "result" above). Spreading the points around the map increases the distance between the points. This is more likely to lead to correct placement of points around the entire map. If possible this should be done but not if it means using less accurate GPS values for each calibration point entered.<p>The GPS value of the calibration points can be determined in any way. A way that is often accurate and easy is to use an online mapping site that contains an image that shows the same points that are contained in the map image used in OED. Then click on that point on the map to get the GPS value. While OED does not endorse any particular online map, a popular one is Google Maps. With this one can right click on any point on a map to reveal information about that point. The first one is the GPS coordinates. If one left clicks on the GPS coordinate it will copy it to the clipboard. Then paste this value into the OED box to input GPS coordinates during the calibration steps described above. Another technique is to physically go to the point on the map and use a cell phone application that shows the current GPS location. Whatever technique used, it is important to get accurate values so the calibration is of high quality.<h3 id="calibrationResult">Calibration result</h3><p>OED gives a result that provides an idea of how far off the calibration points are from each other. This gives an idea of how accurately OED will place circles on the map. For example, three calibration points were entered on the map above where each one was changed by +/- 0.0001, which changes in the 6th digit. This was done so the first calibration point had latitude and longitude increased by this amount, the second decreased by this amount and the third had latitude increased and longitude decreased by this amount. As such, it was somewhat random if the value increased or decreased. These changes were done by using the "Calibrate" button on the admin map viewing page so the map did not have to be reloaded into OED. The values used for the map calibration were:<ul><li>top, right corner of Swimming Pool (277, 461) with GPS of 40.00471, -87.99713<li>top, left corner of Cafeteria (34, 238) with GPS of 40.00228, -87.99976<li>bottom, left corner of Housing (100, 35) with GPS of 40.00044, -87.99911</ul><p>This lead to a result of "result: 7.259%, y: 9.312%". Compared to the map above with the more accurate calibration points, the circles in the following figure have moved a little but are in the correct general place. <img alt="admin map small calibration error result" src="../images/adminMapResultOne.png"><p>If the each value is changed +/- 0.001 as done above then the result is much worse. The values used for the map calibration were:<ul><li>top, right corner of Swimming Pool (277, 461) with GPS of 40.00561, -87.99623<li>top, left corner of Cafeteria (34, 238) with GPS of 40.00138, -88.00066<li>bottom, left corner of Housing (100, 35) with GPS of 40.00134, -88.00001</ul><p>The result is "result: 40.234%, y: 97.975%". The result of mapping is shown in the next figure where both are noticeably off. <img alt="admin map larger calibration error result" src="../images/adminMapResultTwo.png"><p>If the change was increased even further then the circles would shift even more and might eventually be off the map. When placement is poor, the map needs to be re-calibrated.<p>Note that the error may not always indicate how poor placement will be. If every point was shifted a positive amount of +0.001 then OED will not find an additional calibration error due to the systematic shift but items placed on the map will be changed (assuming there is no a similar error in where meters are located). The values used for the map calibration were:<ul><li>top, right corner of Swimming Pool (277, 461) with GPS of 40.00561, -87.99623<li>top, left corner of Cafeteria (34, 238) with GPS of 40.00338, -87.99866<li>bottom, left corner of Housing (100, 35) with GPS of 40.00134, -87.99801</ul><p>This example gives a result of "result: 1.202%, y: 0.25%" which is the same small error as the original example. The resulting map graphic is shown in the next figure. Here the "Play Place" meter is no longer on the map. <img alt="admin map larger shift in one direction but no error" src="../images/adminMapResultThree.png"><p>There are many possible reasons that the calibration might be off and we discuss several now. First, it is easy to type in the wrong value for a point. If this happens then correctly reentering the calibration values again will fix the issue. Second, a value for a calibration point is wrong. While a similar result to the first issue, it means rechecking each point to see which one(s) might be off. Third, the accuracy of the points is too low. This requires using another technique to get the values. This can happen, for example, if the map used to get the GPS coordinates has features placed at a different location than on the map you uploaded to OED. It could also happen because manually read GPS values (such as going to a place and using the value shown of a cell phone) are off. This is due to the inherent accuracy of the device in getting the GPS coordinate or standing in the correct location. Finally, it is possible that the true north angle is off. This will generally lead to items not showing up on the map and/or being off across all meters/groups. While many issues can happen, the OED project found that getting the correct value is usually possible and led to good placement on the map. Getting a good calibration is the easiest way to place items on the map. See the next section for ideas on fixing poor placement of the circles on the map.<h3 id="circlePlacementIssues">Circle placement issues</h3><p>If the best possible has been done to calibrate the map but circle(s) are still in the wrong place then fixing them manually in the meter GPS value is an option. OED only uses the GPS value for placing items on maps so fudging this value does not have other consequences or lead to incorrect results. This is usually easiest if the circles are reasonably close to the desired location on the map. Going back to the first calibration error example where it was +/-0.0001, it is seen that both meters are a little low on the map. Looking at GPS values for this map indicates that as the latitude gets larger the placement goes up (and as the longitude gets smaller (more negative) the placement goes left). Given small changes in GPS value can have large effects on a small map, the latitude was changed by +0.0005 so the new meter values are:<ul><li>Play Place with GPS of 40.00469, -87.99916<li>Theater with GPS of 40.0032, -87.9975</ul><p>By using the <a href="../adminMapViewing/">Admin Map Viewing</a> page, the GPS values were changed. This moved both meters much too far up. Next a latitude shift (from the original values) of +0.00007 was tried so the new values used were:<ul><li>Play Place with GPS of 40.00426, -87.99916<li>Theater with GPS of 40.00277, -87.9975</ul><p>This was still too high but much better as shown in the next figure. <img alt="admin map second shift attempt" src="../images/adminMapShiftTwo.png" width="385"><p>Finally, the latitude was shifted by +0.000015 to give:<ul><li>Play Place with GPS of 40.004205, -87.99916<li>Theater with GPS of 40.002715, -87.9975</ul><p>This was pretty good as shown in the next figure. Some more adjustment could have been made if desired. This does show that very small changes in GPS values can have large shifts on a small map. <img alt="admin map third shift attempt" src="../images/adminMapShiftThree.png" width="407"><p>One thing to note is that this process is only done once when a new map is loaded. After that, any user will see the correct result. Also, once you move one point on the map it becomes clearer the amount needed for other circles so it usually takes less time.<p>There are circumstance that can make it impossible to modify the meter GPS to get it in the correct place on the map. One is if the needed correction means the GPS value goes outside allowed values then OED will not allow the entry of this GPS value. This should only happen if the calibration is off significantly and should be rectified if the map calibration is redone with greater accuracy. A second is if two maps overlap in area so changing the GPS of a meter causes one map to be fine but another now has it in the wrong place. Proper calibration is the solution in this case.<h2 id="details">Details</h2><p>While all these examples were for meters, the same ideas apply equally to groups.</div></div></article></div></div><div id="up-to-top" class="row"><div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a></div></div><footer id="footer-content" class="bg-grau"><div id="footer"><div class="row"> <noscript><div class="alert-box warning "><p>Some aspect of this site will not work and others will work better if you enable JavaScript.</div></noscript></div><div class="row"><div class="medium-6 large-5 columns"><h5 class="shadow-black">About This Site</h5><p class="shadow-black"> The OED dashboard allows organization to acquire, archive, analyze and display energy/resource usage. <a href="https://openenergydashboard.org/features/">More ›</a></div><div class="small-6 medium-3 large-3 large-offset-1 columns"><h5 class="shadow-black">Services</h5><ul class="no-bullet shadow-black"><li > <a href="https://openenergydashboard.org/" title=""></a><li > <a href="https://openenergydashboard.org/contact/" title="Contact">Contact</a><li > <a href="https://openenergydashboard.org/sitemap.xml" title="Sitemap for Google Webmaster Tools">sitemap.xml</a></ul></div><div class="small-6 medium-3 large-3 columns"><ul class="no-bullet shadow-black"></ul></div></div></div><div id="subfooter"><nav class="row"><section id="subfooter-left" class="small-12 medium-6 columns credits"><p>Created by the OED team using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> based on <a href="https://phlow.github.io/feeling-responsive/">Feeling Responsive</a>. This page is part of the Open Energy Dashboard and is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, you can obtain one at <a href="https://www.mozilla.org/en-US/MPL/2.0/" rel="nofollow">https://www.mozilla.org/en-US/MPL/2.0/</a>.</section><section id="subfooter-right" class="small-12 medium-6 columns"><ul class="inline-list social-icons"><li><a href="https://github.com/OpenEnergyDashboard/OED" target="_blank" class="icon-github" title="Code other repos..."></a></ul></section></nav></div></footer><script src="https://openenergydashboard.org/assets/js/javascript.min.js"></script>
